
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hyperparameter Tuning with Optuna &#8212; ùó¶ùòÅùó≤ùó≤ùóΩùó≤ùòÄùòÅ ùóîùòÄùó∞ùó≤ùóªùòÅ ‚õ∞Ô∏è</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/loss_surface.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Backpropagation on DAGs" href="backpropagation.html" />
    <link rel="prev" title="Blending and Stacking" href="blending-stacking.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/loss_surface.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ùó¶ùòÅùó≤ùó≤ùóΩùó≤ùòÄùòÅ ùóîùòÄùó∞ùó≤ùóªùòÅ ‚õ∞Ô∏è</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  FUNDAMENTALS
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="house-prices.html">
   Pipelines in Scikit-Learn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="blending-stacking.html">
   Blending and Stacking
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Hyperparameter Tuning with Optuna
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DEEP LEARNING
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="backpropagation.html">
   Backpropagation on DAGs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="seb3/tensorflow-nn.html">
   Neural Networks with TensorFlow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="seb3/tensorflow-mechanics.html">
   Mechanics of TensorFlow
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PYTORCH TUTORIALS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="pytorch-intro.html">
   Introduction to PyTorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pytorch-activation.html">
   Activation Functions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  REST APIs with FASTAPI
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="fastapi/ch3.html">
   Developing a RESTful API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fastapi/ch4.html">
   Managing Pydantic Data Models
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/optuna.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/particle1331/steepest-ascent/issues/new?title=Issue%20on%20page%20%2Fnotebooks/optuna.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/particle1331/steepest-ascent/master?urlpath=tree/docs/notebooks/optuna.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basics-with-scikit-learn">
   Basics with scikit-learn
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fine-tuning-random-forest">
     Fine tuning Random Forest
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-algorithms">
     Sampling algorithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualizing-results">
     Visualizing Results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#neural-networks">
   Neural networks
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pruning-based-on-intermediate-values">
     Pruning based on intermediate values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyzing-hyperparameter-interactions">
     Analyzing hyperparameter interactions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-hyperparameters-of-commonly-used-models">
   Appendix: Hyperparameters of commonly used models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#auto-xgboost">
     Auto XGBoost
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Hyperparameter Tuning with Optuna</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basics-with-scikit-learn">
   Basics with scikit-learn
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fine-tuning-random-forest">
     Fine tuning Random Forest
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-algorithms">
     Sampling algorithms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualizing-results">
     Visualizing Results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#neural-networks">
   Neural networks
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pruning-based-on-intermediate-values">
     Pruning based on intermediate values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyzing-hyperparameter-interactions">
     Analyzing hyperparameter interactions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-hyperparameters-of-commonly-used-models">
   Appendix: Hyperparameters of commonly used models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#auto-xgboost">
     Auto XGBoost
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="hyperparameter-tuning-with-optuna">
<h1>Hyperparameter Tuning with Optuna<a class="headerlink" href="#hyperparameter-tuning-with-optuna" title="Permalink to this headline">¬∂</a></h1>
<p>Hyperparameters are <strong>non-learnable parameters</strong> of a model that determine its architecture. The correct choice of hyperparameters could mean the difference between convergence to or divergence from a solution. In this notebook, we explore an open-source library that provides a framework for solving this task. From its docs:</p>
<blockquote>
<div><p><strong>Optuna</strong> is an automatic hyperparameter optimization software framework, particularly designed for machine learning. It features an imperative, <em>define-by-run</em> style user API. Thanks to our <em>define-by-run</em> API, the code written with Optuna enjoys high modularity, and the user of Optuna can dynamically construct the search spaces for the hyperparameters.</p>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference external" href="https://optuna.readthedocs.io/en/stable/faq.html">Optuna FAQ</a></p></li>
<li><p><a class="reference external" href="https://optuna.readthedocs.io/en/stable/index.html">Optuna docs</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1907.10902">Optuna paper</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Experiment config</span>
<span class="n">RF_NTRIALS</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">VGG_NTRIALS</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">CIFAR10_SAMPLE_RATIO</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">CIFAR10_RESIZE</span> <span class="o">=</span> <span class="mi">32</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="basics-with-scikit-learn">
<h2>Basics with scikit-learn<a class="headerlink" href="#basics-with-scikit-learn" title="Permalink to this headline">¬∂</a></h2>
<p>Optuna is a black-box optimizer, which means it only needs an objective function (any function that returns a numerical value) to evaluate the performance of the its parameters, and decide where to sample in upcoming trials. An optimization problem is framed in the Optuna API using two basic concepts: <code class="docutils literal notranslate"><span class="pre">study</span></code> and <code class="docutils literal notranslate"><span class="pre">trial</span></code>.</p>
<p>A study is conceptually an optimization based on an objective function, while a trial is a single execution of an objective function. The combination of hyperparameters for each trial is sampled according to some sampling algorithm defined by the study.</p>
<p>In the following code example, the search space is constructed within imperative Python code, e.g. inside conditionals or loops. On the other hand, recall that for <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> and <code class="docutils literal notranslate"><span class="pre">RandomSearchCV</span></code> in scikit-learn, we had to define the entire search space before running the search algorithm.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Always perform model evaluation on a dataset within a cross-validation framework!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">ensemble</span><span class="p">,</span> <span class="n">svm</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">joblib</span>


<span class="c1"># (1) Define an objective function to be maximized.</span>
<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    
    <span class="c1"># (2) Suggest values for the hyperparameters using trial object.</span>
    <span class="n">clf_name</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;SVC&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomForest&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">clf_name</span> <span class="o">==</span> <span class="s1">&#39;SVC&#39;</span><span class="p">:</span>
        <span class="n">svc_c</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_loguniform</span><span class="p">(</span><span class="s1">&#39;svc_c&#39;</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e10</span><span class="p">)</span>
        <span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">svc_c</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rf_max_depth</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">suggest_loguniform</span><span class="p">(</span><span class="s1">&#39;rf_max_depth&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
        <span class="n">clf</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">rf_max_depth</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="n">score</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">score</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># (3) Create a study object and optimize the objective function.</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">[I 2022-01-09 16:43:23,964]</span> A new study created in memory with name: no-name-54f1a555-fa15-42c3-8253-bf2ed881f9d2
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:26,066]</span> Trial 0 finished with value: 0.9490607048594939 and parameters: {&#39;classifier&#39;: &#39;RandomForest&#39;, &#39;rf_max_depth&#39;: 17.073087050633617}. Best is trial 0 with value: 0.9490607048594939.
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:26,171]</span> Trial 1 finished with value: 0.9542928116752056 and parameters: {&#39;classifier&#39;: &#39;RandomForest&#39;, &#39;rf_max_depth&#39;: 13.974140377683506}. Best is trial 1 with value: 0.9542928116752056.
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:26,250]</span> Trial 2 finished with value: 0.6274181027790716 and parameters: {&#39;classifier&#39;: &#39;SVC&#39;, &#39;svc_c&#39;: 181956.84041464477}. Best is trial 1 with value: 0.9542928116752056.
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:26,330]</span> Trial 3 finished with value: 0.6274181027790716 and parameters: {&#39;classifier&#39;: &#39;SVC&#39;, &#39;svc_c&#39;: 864898.4184373791}. Best is trial 1 with value: 0.9542928116752056.
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:26,432]</span> Trial 4 finished with value: 0.9613569321533924 and parameters: {&#39;classifier&#39;: &#39;RandomForest&#39;, &#39;rf_max_depth&#39;: 9.727521922319935}. Best is trial 4 with value: 0.9613569321533924.
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">study</span></code> object saves the result of evaluating the objective each trial ‚Äî which is essentially some choice of hyperparameters to evaluate. In the above study, the problem of model selection is framed as a hyperparameter optimization problem. Here we choose between an SVM-based algorithm or Random Forest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">trials_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>number</th>
      <th>value</th>
      <th>datetime_start</th>
      <th>datetime_complete</th>
      <th>duration</th>
      <th>params_classifier</th>
      <th>params_rf_max_depth</th>
      <th>params_svc_c</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.949061</td>
      <td>2022-01-09 16:43:23.966991</td>
      <td>2022-01-09 16:43:26.066287</td>
      <td>0 days 00:00:02.099296</td>
      <td>RandomForest</td>
      <td>17.073087</td>
      <td>NaN</td>
      <td>COMPLETE</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0.954293</td>
      <td>2022-01-09 16:43:26.068106</td>
      <td>2022-01-09 16:43:26.171510</td>
      <td>0 days 00:00:00.103404</td>
      <td>RandomForest</td>
      <td>13.974140</td>
      <td>NaN</td>
      <td>COMPLETE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0.627418</td>
      <td>2022-01-09 16:43:26.172781</td>
      <td>2022-01-09 16:43:26.250413</td>
      <td>0 days 00:00:00.077632</td>
      <td>SVC</td>
      <td>NaN</td>
      <td>181956.840415</td>
      <td>COMPLETE</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0.627418</td>
      <td>2022-01-09 16:43:26.251880</td>
      <td>2022-01-09 16:43:26.329750</td>
      <td>0 days 00:00:00.077870</td>
      <td>SVC</td>
      <td>NaN</td>
      <td>864898.418437</td>
      <td>COMPLETE</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0.961357</td>
      <td>2022-01-09 16:43:26.331104</td>
      <td>2022-01-09 16:43:26.432237</td>
      <td>0 days 00:00:00.101133</td>
      <td>RandomForest</td>
      <td>9.727522</td>
      <td>NaN</td>
      <td>COMPLETE</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="fine-tuning-random-forest">
<h3>Fine tuning Random Forest<a class="headerlink" href="#fine-tuning-random-forest" title="Permalink to this headline">¬∂</a></h3>
<p>Here we focus on tuning a single Random Forest model. Then, plot the accuracy for each pair of hyperparameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    
    <span class="n">max_depth</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s1">&#39;max_depth&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
    <span class="n">max_features</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s1">&#39;max_features&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">n_estimators</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s1">&#39;criterion&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">])</span>
    
    <span class="n">clf</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestClassifier</span><span class="p">(</span>
        <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span>
        <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
        <span class="n">max_features</span><span class="o">=</span><span class="n">max_features</span><span class="p">,</span>
        <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>   
    
    <span class="n">score</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">score</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>


<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="n">RF_NTRIALS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">[I 2022-01-09 16:43:26,890]</span> A new study created in memory with name: no-name-115a68d2-ab3d-4fb7-863e-40264b640ac5
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:31,170]</span> Trial 0 finished with value: 0.9666356155876418 and parameters: {&#39;max_depth&#39;: 70, &#39;max_features&#39;: 0.4553140329238048, &#39;n_estimators&#39;: 353, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:33,757]</span> Trial 1 finished with value: 0.9490607048594939 and parameters: {&#39;max_depth&#39;: 2, &#39;max_features&#39;: 0.8793554962469481, &#39;n_estimators&#39;: 217, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:46,501]</span> Trial 2 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 112, &#39;max_features&#39;: 0.8957261207990624, &#39;n_estimators&#39;: 679, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:51,862]</span> Trial 3 finished with value: 0.95960254618848 and parameters: {&#39;max_depth&#39;: 52, &#39;max_features&#39;: 0.131096167102392, &#39;n_estimators&#39;: 688, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:43:52,930]</span> Trial 4 finished with value: 0.9543393882937432 and parameters: {&#39;max_depth&#39;: 89, &#39;max_features&#39;: 0.19757680095203894, &#39;n_estimators&#39;: 123, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:04,891]</span> Trial 5 finished with value: 0.9596180717279925 and parameters: {&#39;max_depth&#39;: 43, &#39;max_features&#39;: 0.745646516579023, &#39;n_estimators&#39;: 799, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:05,977]</span> Trial 6 finished with value: 0.9455364073901567 and parameters: {&#39;max_depth&#39;: 2, &#39;max_features&#39;: 0.4305160160128184, &#39;n_estimators&#39;: 120, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:10,074]</span> Trial 7 finished with value: 0.9525694767893184 and parameters: {&#39;max_depth&#39;: 2, &#39;max_features&#39;: 0.5896358956701836, &#39;n_estimators&#39;: 395, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:11,713]</span> Trial 8 finished with value: 0.9648657040832168 and parameters: {&#39;max_depth&#39;: 8, &#39;max_features&#39;: 0.2725360621622547, &#39;n_estimators&#39;: 107, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:13,789]</span> Trial 9 finished with value: 0.9631268436578171 and parameters: {&#39;max_depth&#39;: 17, &#39;max_features&#39;: 0.42336296524868955, &#39;n_estimators&#39;: 186, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 0 with value: 0.9666356155876418.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:19,421]</span> Trial 10 finished with value: 0.9683900015525542 and parameters: {&#39;max_depth&#39;: 17, &#39;max_features&#39;: 0.6271061861322312, &#39;n_estimators&#39;: 390, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:24,714]</span> Trial 11 finished with value: 0.9666200900481291 and parameters: {&#39;max_depth&#39;: 15, &#39;max_features&#39;: 0.5822621323950136, &#39;n_estimators&#39;: 383, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:30,752]</span> Trial 12 finished with value: 0.9631113181183046 and parameters: {&#39;max_depth&#39;: 7, &#39;max_features&#39;: 0.6914246020496978, &#39;n_estimators&#39;: 394, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:34,208]</span> Trial 13 finished with value: 0.9666356155876418 and parameters: {&#39;max_depth&#39;: 31, &#39;max_features&#39;: 0.4008483203477205, &#39;n_estimators&#39;: 295, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:42,058]</span> Trial 14 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 5, &#39;max_features&#39;: 0.697074880558194, &#39;n_estimators&#39;: 515, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:46,095]</span> Trial 15 finished with value: 0.968390001552554 and parameters: {&#39;max_depth&#39;: 25, &#39;max_features&#39;: 0.4911415937971424, &#39;n_estimators&#39;: 266, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:48,194]</span> Trial 16 finished with value: 0.9666200900481291 and parameters: {&#39;max_depth&#39;: 23, &#39;max_features&#39;: 0.29947419424183597, &#39;n_estimators&#39;: 207, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:51,542]</span> Trial 17 finished with value: 0.9648812296227295 and parameters: {&#39;max_depth&#39;: 9, &#39;max_features&#39;: 0.5232400508998625, &#39;n_estimators&#39;: 259, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:44:54,420]</span> Trial 18 finished with value: 0.9666356155876418 and parameters: {&#39;max_depth&#39;: 4, &#39;max_features&#39;: 0.7925469586846491, &#39;n_estimators&#39;: 158, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:03,962]</span> Trial 19 finished with value: 0.9648657040832168 and parameters: {&#39;max_depth&#39;: 26, &#39;max_features&#39;: 0.9916274673184882, &#39;n_estimators&#39;: 504, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:08,247]</span> Trial 20 finished with value: 0.9683900015525542 and parameters: {&#39;max_depth&#39;: 11, &#39;max_features&#39;: 0.6494072971899049, &#39;n_estimators&#39;: 282, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:12,318]</span> Trial 21 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 12, &#39;max_features&#39;: 0.6177131689895455, &#39;n_estimators&#39;: 281, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:17,211]</span> Trial 22 finished with value: 0.9666356155876418 and parameters: {&#39;max_depth&#39;: 18, &#39;max_features&#39;: 0.5182258148253241, &#39;n_estimators&#39;: 307, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:24,171]</span> Trial 23 finished with value: 0.9666356155876418 and parameters: {&#39;max_depth&#39;: 37, &#39;max_features&#39;: 0.6435668892225698, &#39;n_estimators&#39;: 483, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:27,362]</span> Trial 24 finished with value: 0.9683744760130415 and parameters: {&#39;max_depth&#39;: 11, &#39;max_features&#39;: 0.35658896664659767, &#39;n_estimators&#39;: 262, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:30,324]</span> Trial 25 finished with value: 0.9631268436578171 and parameters: {&#39;max_depth&#39;: 4, &#39;max_features&#39;: 0.5129171273311892, &#39;n_estimators&#39;: 233, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:32,922]</span> Trial 26 finished with value: 0.968390001552554 and parameters: {&#39;max_depth&#39;: 23, &#39;max_features&#39;: 0.778630164750195, &#39;n_estimators&#39;: 161, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:35,628]</span> Trial 27 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 6, &#39;max_features&#39;: 0.8630561237098009, &#39;n_estimators&#39;: 160, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:40,807]</span> Trial 28 finished with value: 0.9613569321533924 and parameters: {&#39;max_depth&#39;: 60, &#39;max_features&#39;: 0.6694356886834675, &#39;n_estimators&#39;: 329, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:43,343]</span> Trial 29 finished with value: 0.968390001552554 and parameters: {&#39;max_depth&#39;: 12, &#39;max_features&#39;: 0.7888952063202767, &#39;n_estimators&#39;: 156, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:51,958]</span> Trial 30 finished with value: 0.9666200900481291 and parameters: {&#39;max_depth&#39;: 10, &#39;max_features&#39;: 0.8231032780230729, &#39;n_estimators&#39;: 466, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:57,365]</span> Trial 31 finished with value: 0.9631113181183046 and parameters: {&#39;max_depth&#39;: 24, &#39;max_features&#39;: 0.7211108291204642, &#39;n_estimators&#39;: 347, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:45:59,919]</span> Trial 32 finished with value: 0.9648812296227295 and parameters: {&#39;max_depth&#39;: 14, &#39;max_features&#39;: 0.46511497343641706, &#39;n_estimators&#39;: 185, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:02,532]</span> Trial 33 finished with value: 0.9631113181183046 and parameters: {&#39;max_depth&#39;: 20, &#39;max_features&#39;: 0.964559544639612, &#39;n_estimators&#39;: 144, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:04,800]</span> Trial 34 finished with value: 0.968390001552554 and parameters: {&#39;max_depth&#39;: 38, &#39;max_features&#39;: 0.7857210353437216, &#39;n_estimators&#39;: 139, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:07,063]</span> Trial 35 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 75, &#39;max_features&#39;: 0.895797389597036, &#39;n_estimators&#39;: 130, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:09,979]</span> Trial 36 finished with value: 0.9561248253376805 and parameters: {&#39;max_depth&#39;: 13, &#39;max_features&#39;: 0.7649210639345877, &#39;n_estimators&#39;: 181, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:20,083]</span> Trial 37 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 44, &#39;max_features&#39;: 0.8414076312474784, &#39;n_estimators&#39;: 586, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:22,673]</span> Trial 38 finished with value: 0.959633597267505 and parameters: {&#39;max_depth&#39;: 31, &#39;max_features&#39;: 0.9157629156491569, &#39;n_estimators&#39;: 112, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:25,901]</span> Trial 39 finished with value: 0.9631113181183046 and parameters: {&#39;max_depth&#39;: 90, &#39;max_features&#39;: 0.5920529250625748, &#39;n_estimators&#39;: 234, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:28,403]</span> Trial 40 finished with value: 0.9578636857630801 and parameters: {&#39;max_depth&#39;: 50, &#39;max_features&#39;: 0.4783828410020865, &#39;n_estimators&#39;: 210, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:30,639]</span> Trial 41 finished with value: 0.9666200900481293 and parameters: {&#39;max_depth&#39;: 35, &#39;max_features&#39;: 0.7619950855295334, &#39;n_estimators&#39;: 140, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:33,715]</span> Trial 42 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 18, &#39;max_features&#39;: 0.8225784733771202, &#39;n_estimators&#39;: 165, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:39,850]</span> Trial 43 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 8, &#39;max_features&#39;: 0.6383086887951374, &#39;n_estimators&#39;: 424, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:41,282]</span> Trial 44 finished with value: 0.968390001552554 and parameters: {&#39;max_depth&#39;: 15, &#39;max_features&#39;: 0.5614932520792806, &#39;n_estimators&#39;: 105, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:43,221]</span> Trial 45 finished with value: 0.95960254618848 and parameters: {&#39;max_depth&#39;: 16, &#39;max_features&#39;: 0.5770286382877312, &#39;n_estimators&#39;: 116, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:45,250]</span> Trial 46 finished with value: 0.95960254618848 and parameters: {&#39;max_depth&#39;: 21, &#39;max_features&#39;: 0.7212775690363596, &#39;n_estimators&#39;: 132, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:46,616]</span> Trial 47 finished with value: 0.959633597267505 and parameters: {&#39;max_depth&#39;: 6, &#39;max_features&#39;: 0.6562034355804018, &#39;n_estimators&#39;: 100, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:48,092]</span> Trial 48 finished with value: 0.9578481602235677 and parameters: {&#39;max_depth&#39;: 10, &#39;max_features&#39;: 0.568523166767695, &#39;n_estimators&#39;: 106, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:46:49,911]</span> Trial 49 finished with value: 0.9630957925787922 and parameters: {&#39;max_depth&#39;: 112, &#39;max_features&#39;: 0.699359173921984, &#39;n_estimators&#39;: 121, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:00,045]</span> Trial 50 finished with value: 0.9578326346840553 and parameters: {&#39;max_depth&#39;: 3, &#39;max_features&#39;: 0.5481122335205243, &#39;n_estimators&#39;: 752, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:02,972]</span> Trial 51 finished with value: 0.968390001552554 and parameters: {&#39;max_depth&#39;: 27, &#39;max_features&#39;: 0.39001770767458754, &#39;n_estimators&#39;: 253, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:07,331]</span> Trial 52 finished with value: 0.9666200900481291 and parameters: {&#39;max_depth&#39;: 14, &#39;max_features&#39;: 0.3665759432560646, &#39;n_estimators&#39;: 370, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:09,647]</span> Trial 53 finished with value: 0.9666200900481293 and parameters: {&#39;max_depth&#39;: 12, &#39;max_features&#39;: 0.7502318513015229, &#39;n_estimators&#39;: 147, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:13,113]</span> Trial 54 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 29, &#39;max_features&#39;: 0.11090149242752717, &#39;n_estimators&#39;: 425, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:18,247]</span> Trial 55 finished with value: 0.9648657040832169 and parameters: {&#39;max_depth&#39;: 16, &#39;max_features&#39;: 0.6231007776650471, &#39;n_estimators&#39;: 323, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:20,473]</span> Trial 56 finished with value: 0.9648657040832168 and parameters: {&#39;max_depth&#39;: 22, &#39;max_features&#39;: 0.20795797506889363, &#39;n_estimators&#39;: 236, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:23,328]</span> Trial 57 finished with value: 0.9596180717279925 and parameters: {&#39;max_depth&#39;: 38, &#39;max_features&#39;: 0.6780950529433282, &#39;n_estimators&#39;: 200, &#39;criterion&#39;: &#39;gini&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:26,805]</span> Trial 58 finished with value: 0.968390001552554 and parameters: {&#39;max_depth&#39;: 7, &#39;max_features&#39;: 0.7932031603255675, &#39;n_estimators&#39;: 169, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 10 with value: 0.9683900015525542.
<span class=" -Color -Color-Green">[I 2022-01-09 16:47:33,794]</span> Trial 59 finished with value: 0.9701443875174661 and parameters: {&#39;max_depth&#39;: 28, &#39;max_features&#39;: 0.4278318142755836, &#39;n_estimators&#39;: 596, &#39;criterion&#39;: &#39;entropy&#39;}. Best is trial 59 with value: 0.9701443875174661.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">best_params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;max_depth&#39;: 28,
 &#39;max_features&#39;: 0.4278318142755836,
 &#39;n_estimators&#39;: 596,
 &#39;criterion&#39;: &#39;entropy&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">best_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9701443875174661
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sampling-algorithms">
<h3>Sampling algorithms<a class="headerlink" href="#sampling-algorithms" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">cb</span><span class="p">):</span>
    <span class="n">study</span><span class="o">.</span><span class="n">trials_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;jet&quot;</span><span class="p">),</span> 
        <span class="n">colorbar</span><span class="o">=</span><span class="n">cb</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">plot_results</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="s1">&#39;params_max_depth&#39;</span><span class="p">,</span>    <span class="s1">&#39;params_n_estimators&#39;</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plot_results</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="s1">&#39;params_max_depth&#39;</span><span class="p">,</span>    <span class="s1">&#39;params_max_features&#39;</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plot_results</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="s1">&#39;params_n_estimators&#39;</span><span class="p">,</span> <span class="s1">&#39;params_max_features&#39;</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/optuna_16_0.png" src="../_images/optuna_16_0.png" />
</div>
</div>
<p><strong>Figure.</strong> TPE in action. Optuna uses  <strong>Tree-structured Parzen Estimater (TPE)</strong> <span id="id1">[<a class="reference internal" href="../intro.html#id10">BBBK11</a>]</span> as the default sampler which is a form of Bayesian optimization. Observe that the hyperparameter space is searched more efficiently than random search with the sampler choosing points closer to previous good results. Samplers are specified when creating a study:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">,</span> <span class="n">sampler</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">TPESampler</span><span class="p">())</span>
</pre></div>
</div>
<p>From the <a class="reference external" href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.samplers.TPESampler.html#optuna.samplers.TPESampler">docs</a>:</p>
<blockquote>
<div><p>On each trial, for each parameter, TPE fits one Gaussian Mixture Model (GMM) <code class="docutils literal notranslate"><span class="pre">l(x)</span></code> to the set of parameter values associated with the best objective values, and another GMM <code class="docutils literal notranslate"><span class="pre">g(x)</span></code> to the remaining parameter values. It chooses the parameter value <code class="docutils literal notranslate"><span class="pre">x</span></code> that maximizes the ratio <code class="docutils literal notranslate"><span class="pre">l(x)/g(x)</span></code>.</p>
</div></blockquote>
<p>Thus, TPE samples every hyperparameter <strong>independently</strong> ‚Äî no explicit hyperparameter interactions are considered when sampling future trials, although other parameters implicitly affect objective value. Optuna also implements our old friends random and grid search in the following samplers:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">optuna.samplers.GridSampler</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optuna.samplers.RandomSampler</span></code></p></li>
</ul>
<p>Another sampling algorithm implemented in Optuna is <strong>Covariance Matrix Adaptation Evolution Strategy (CMA-ES)</strong> <span id="id2">[<a class="reference internal" href="../intro.html#id3">Han16</a>]</span>. This algorithm is designed to tackle ill-conditioned, non-separable problems, i.e. cannot be solved by solving several 1-dimensional problems. CMA-ES is typically implemented along with TPE whenever the former algorithm is not applicable, e.g. for searching dynamically constructed hyperparameters (as CMA-ES requires that parameters are specified statically prior to the optimization) or for searching categorical parameters, as CMA-ES is designed to search real parameters on a continuous domain. TPE+CMA-ES sampling can be implemented as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">CmaEsSampler</span><span class="p">(</span>
    <span class="n">warn_independent_sampling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">independent_sampler</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">TPESampler</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Results from the paper <span id="id3">[<a class="reference internal" href="../intro.html#id4">ASY+19</a>]</span> show that TPE+CMA-ES works better than counterparts of the same time complexity:</p>
<div class="figure align-default" id="fig9-optuna">
<a class="reference internal image-reference" href="../_images/fig9-optuna.png"><img alt="../_images/fig9-optuna.png" src="../_images/fig9-optuna.png" style="width: 35em;" /></a>
</div>
<div class="figure align-default" id="fig10-optuna">
<a class="reference internal image-reference" href="../_images/fig10-optuna.png"><img alt="../_images/fig10-optuna.png" src="../_images/fig10-optuna.png" style="width: 35em;" /></a>
</div>
<div class="figure align-default" id="optuna-results">
<a class="reference internal image-reference" href="../_images/optuna-results.png"><img alt="../_images/optuna-results.png" src="../_images/optuna-results.png" style="width: 35em;" /></a>
</div>
</div>
<div class="section" id="visualizing-results">
<h3>Visualizing Results<a class="headerlink" href="#visualizing-results" title="Permalink to this headline">¬∂</a></h3>
<p>Optuna provides visualization functions in the <code class="docutils literal notranslate"><span class="pre">optuna.visualization</span></code> library <a class="footnote-reference brackets" href="#ref4" id="id4">1</a>. The following plot shows the best objective value found as the trials progress. The increasing trend in accuracy indicates that the TPE sampler is working well, i.e. the search algorithm learns from previous trials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_optimization_history</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.6.3.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>
</div><div class="output text_html"><div>                            <div id="acf7ad46-b11b-4fe4-822f-622feeaa446c" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("acf7ad46-b11b-4fe4-822f-622feeaa446c")) {                    Plotly.newPlot(                        "acf7ad46-b11b-4fe4-822f-622feeaa446c",                        [{"mode":"markers","name":"Objective Value","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.9666356155876418,0.9490607048594939,0.9648657040832169,0.95960254618848,0.9543393882937432,0.9596180717279925,0.9455364073901567,0.9525694767893184,0.9648657040832168,0.9631268436578171,0.9683900015525542,0.9666200900481291,0.9631113181183046,0.9666356155876418,0.9648657040832169,0.968390001552554,0.9666200900481291,0.9648812296227295,0.9666356155876418,0.9648657040832168,0.9683900015525542,0.9648657040832169,0.9666356155876418,0.9666356155876418,0.9683744760130415,0.9631268436578171,0.968390001552554,0.9648657040832169,0.9613569321533924,0.968390001552554,0.9666200900481291,0.9631113181183046,0.9648812296227295,0.9631113181183046,0.968390001552554,0.9648657040832169,0.9561248253376805,0.9648657040832169,0.959633597267505,0.9631113181183046,0.9578636857630801,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.968390001552554,0.95960254618848,0.95960254618848,0.959633597267505,0.9578481602235677,0.9630957925787922,0.9578326346840553,0.968390001552554,0.9666200900481291,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.9648657040832168,0.9596180717279925,0.968390001552554,0.9701443875174661],"type":"scatter"},{"name":"Best Value","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.9666356155876418,0.9666356155876418,0.9666356155876418,0.9666356155876418,0.9666356155876418,0.9666356155876418,0.9666356155876418,0.9666356155876418,0.9666356155876418,0.9666356155876418,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9683900015525542,0.9701443875174661],"type":"scatter"}],                        {"title":{"text":"Optimization History Plot"},"xaxis":{"title":{"text":"#Trials"}},"yaxis":{"title":{"text":"Objective Value"}},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('acf7ad46-b11b-4fe4-822f-622feeaa446c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<p>The <strong>parallel coordinate plot</strong> gives us a feel of how the hyperparameters interact. To isolate subsets of lines, we can use the interactive capabilities of the plots by dragging on each axis to restrict it. The resulting purple bars can be disjoint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_parallel_coordinate</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="4b9edac2-8e58-4564-97a7-4bb83898ca92" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4b9edac2-8e58-4564-97a7-4bb83898ca92")) {                    Plotly.newPlot(                        "4b9edac2-8e58-4564-97a7-4bb83898ca92",                        [{"dimensions":[{"label":"Objective Value","range":[0.9455364073901567,0.9701443875174661],"values":[0.9666356155876418,0.9490607048594939,0.9648657040832169,0.95960254618848,0.9543393882937432,0.9596180717279925,0.9455364073901567,0.9525694767893184,0.9648657040832168,0.9631268436578171,0.9683900015525542,0.9666200900481291,0.9631113181183046,0.9666356155876418,0.9648657040832169,0.968390001552554,0.9666200900481291,0.9648812296227295,0.9666356155876418,0.9648657040832168,0.9683900015525542,0.9648657040832169,0.9666356155876418,0.9666356155876418,0.9683744760130415,0.9631268436578171,0.968390001552554,0.9648657040832169,0.9613569321533924,0.968390001552554,0.9666200900481291,0.9631113181183046,0.9648812296227295,0.9631113181183046,0.968390001552554,0.9648657040832169,0.9561248253376805,0.9648657040832169,0.959633597267505,0.9631113181183046,0.9578636857630801,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.968390001552554,0.95960254618848,0.95960254618848,0.959633597267505,0.9578481602235677,0.9630957925787922,0.9578326346840553,0.968390001552554,0.9666200900481291,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.9648657040832168,0.9596180717279925,0.968390001552554,0.9701443875174661]},{"label":"criterion","range":[0,1],"ticktext":["entropy","gini"],"tickvals":[0,1],"values":[0,1,0,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0]},{"label":"max_depth","range":[2,112],"values":[70,2,112,52,89,43,2,2,8,17,17,15,7,31,5,25,23,9,4,26,11,12,18,37,11,4,23,6,60,12,10,24,14,20,38,75,13,44,31,90,50,35,18,8,15,16,21,6,10,112,3,27,14,12,29,16,22,38,7,28]},{"label":"max_features","range":[0.11090149242752717,0.9916274673184882],"values":[0.4553140329238048,0.8793554962469481,0.8957261207990624,0.131096167102392,0.19757680095203894,0.745646516579023,0.4305160160128184,0.5896358956701836,0.2725360621622547,0.42336296524868955,0.6271061861322312,0.5822621323950136,0.6914246020496978,0.4008483203477205,0.697074880558194,0.4911415937971424,0.29947419424183597,0.5232400508998625,0.7925469586846491,0.9916274673184882,0.6494072971899049,0.6177131689895455,0.5182258148253241,0.6435668892225698,0.35658896664659767,0.5129171273311892,0.778630164750195,0.8630561237098009,0.6694356886834675,0.7888952063202767,0.8231032780230729,0.7211108291204642,0.46511497343641706,0.964559544639612,0.7857210353437216,0.895797389597036,0.7649210639345877,0.8414076312474784,0.9157629156491569,0.5920529250625748,0.4783828410020865,0.7619950855295334,0.8225784733771202,0.6383086887951374,0.5614932520792806,0.5770286382877312,0.7212775690363596,0.6562034355804018,0.568523166767695,0.699359173921984,0.5481122335205243,0.39001770767458754,0.3665759432560646,0.7502318513015229,0.11090149242752717,0.6231007776650471,0.20795797506889363,0.6780950529433282,0.7932031603255675,0.4278318142755836]},{"label":"n_estimators","range":[100,799],"values":[353,217,679,688,123,799,120,395,107,186,390,383,394,295,515,266,207,259,158,504,282,281,307,483,262,233,161,160,329,156,466,347,185,144,139,130,181,586,112,234,210,140,165,424,105,116,132,100,106,121,752,253,370,147,425,323,236,200,169,596]}],"labelangle":30,"labelside":"bottom","line":{"color":[0.9666356155876418,0.9490607048594939,0.9648657040832169,0.95960254618848,0.9543393882937432,0.9596180717279925,0.9455364073901567,0.9525694767893184,0.9648657040832168,0.9631268436578171,0.9683900015525542,0.9666200900481291,0.9631113181183046,0.9666356155876418,0.9648657040832169,0.968390001552554,0.9666200900481291,0.9648812296227295,0.9666356155876418,0.9648657040832168,0.9683900015525542,0.9648657040832169,0.9666356155876418,0.9666356155876418,0.9683744760130415,0.9631268436578171,0.968390001552554,0.9648657040832169,0.9613569321533924,0.968390001552554,0.9666200900481291,0.9631113181183046,0.9648812296227295,0.9631113181183046,0.968390001552554,0.9648657040832169,0.9561248253376805,0.9648657040832169,0.959633597267505,0.9631113181183046,0.9578636857630801,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.968390001552554,0.95960254618848,0.95960254618848,0.959633597267505,0.9578481602235677,0.9630957925787922,0.9578326346840553,0.968390001552554,0.9666200900481291,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.9648657040832168,0.9596180717279925,0.968390001552554,0.9701443875174661],"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"reversescale":false,"showscale":true},"type":"parcoords"}],                        {"title":{"text":"Parallel Coordinate Plot"},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('4b9edac2-8e58-4564-97a7-4bb83898ca92');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<p>The following <strong>slice plots</strong> show the projections of the sampler‚Äôs path in the hyperparameter space in each individual dimension, then shifts each point along the vertical axis based on the its objective value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_slice</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="9dde7497-4105-4b30-bd7b-c4eaaeeb42fb" class="plotly-graph-div" style="height:400px; width:900px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9dde7497-4105-4b30-bd7b-c4eaaeeb42fb")) {                    Plotly.newPlot(                        "9dde7497-4105-4b30-bd7b-c4eaaeeb42fb",                        [{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":true},"mode":"markers","showlegend":false,"x":["entropy","gini","entropy","gini","gini","gini","gini","gini","entropy","gini","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","gini","entropy","gini","entropy","gini","entropy","entropy","entropy","entropy","entropy","entropy","gini","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","gini","entropy","entropy"],"y":[0.9666356155876418,0.9490607048594939,0.9648657040832169,0.95960254618848,0.9543393882937432,0.9596180717279925,0.9455364073901567,0.9525694767893184,0.9648657040832168,0.9631268436578171,0.9683900015525542,0.9666200900481291,0.9631113181183046,0.9666356155876418,0.9648657040832169,0.968390001552554,0.9666200900481291,0.9648812296227295,0.9666356155876418,0.9648657040832168,0.9683900015525542,0.9648657040832169,0.9666356155876418,0.9666356155876418,0.9683744760130415,0.9631268436578171,0.968390001552554,0.9648657040832169,0.9613569321533924,0.968390001552554,0.9666200900481291,0.9631113181183046,0.9648812296227295,0.9631113181183046,0.968390001552554,0.9648657040832169,0.9561248253376805,0.9648657040832169,0.959633597267505,0.9631113181183046,0.9578636857630801,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.968390001552554,0.95960254618848,0.95960254618848,0.959633597267505,0.9578481602235677,0.9630957925787922,0.9578326346840553,0.968390001552554,0.9666200900481291,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.9648657040832168,0.9596180717279925,0.968390001552554,0.9701443875174661],"type":"scatter","xaxis":"x","yaxis":"y"},{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[70,2,112,52,89,43,2,2,8,17,17,15,7,31,5,25,23,9,4,26,11,12,18,37,11,4,23,6,60,12,10,24,14,20,38,75,13,44,31,90,50,35,18,8,15,16,21,6,10,112,3,27,14,12,29,16,22,38,7,28],"y":[0.9666356155876418,0.9490607048594939,0.9648657040832169,0.95960254618848,0.9543393882937432,0.9596180717279925,0.9455364073901567,0.9525694767893184,0.9648657040832168,0.9631268436578171,0.9683900015525542,0.9666200900481291,0.9631113181183046,0.9666356155876418,0.9648657040832169,0.968390001552554,0.9666200900481291,0.9648812296227295,0.9666356155876418,0.9648657040832168,0.9683900015525542,0.9648657040832169,0.9666356155876418,0.9666356155876418,0.9683744760130415,0.9631268436578171,0.968390001552554,0.9648657040832169,0.9613569321533924,0.968390001552554,0.9666200900481291,0.9631113181183046,0.9648812296227295,0.9631113181183046,0.968390001552554,0.9648657040832169,0.9561248253376805,0.9648657040832169,0.959633597267505,0.9631113181183046,0.9578636857630801,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.968390001552554,0.95960254618848,0.95960254618848,0.959633597267505,0.9578481602235677,0.9630957925787922,0.9578326346840553,0.968390001552554,0.9666200900481291,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.9648657040832168,0.9596180717279925,0.968390001552554,0.9701443875174661],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[0.4553140329238048,0.8793554962469481,0.8957261207990624,0.131096167102392,0.19757680095203894,0.745646516579023,0.4305160160128184,0.5896358956701836,0.2725360621622547,0.42336296524868955,0.6271061861322312,0.5822621323950136,0.6914246020496978,0.4008483203477205,0.697074880558194,0.4911415937971424,0.29947419424183597,0.5232400508998625,0.7925469586846491,0.9916274673184882,0.6494072971899049,0.6177131689895455,0.5182258148253241,0.6435668892225698,0.35658896664659767,0.5129171273311892,0.778630164750195,0.8630561237098009,0.6694356886834675,0.7888952063202767,0.8231032780230729,0.7211108291204642,0.46511497343641706,0.964559544639612,0.7857210353437216,0.895797389597036,0.7649210639345877,0.8414076312474784,0.9157629156491569,0.5920529250625748,0.4783828410020865,0.7619950855295334,0.8225784733771202,0.6383086887951374,0.5614932520792806,0.5770286382877312,0.7212775690363596,0.6562034355804018,0.568523166767695,0.699359173921984,0.5481122335205243,0.39001770767458754,0.3665759432560646,0.7502318513015229,0.11090149242752717,0.6231007776650471,0.20795797506889363,0.6780950529433282,0.7932031603255675,0.4278318142755836],"y":[0.9666356155876418,0.9490607048594939,0.9648657040832169,0.95960254618848,0.9543393882937432,0.9596180717279925,0.9455364073901567,0.9525694767893184,0.9648657040832168,0.9631268436578171,0.9683900015525542,0.9666200900481291,0.9631113181183046,0.9666356155876418,0.9648657040832169,0.968390001552554,0.9666200900481291,0.9648812296227295,0.9666356155876418,0.9648657040832168,0.9683900015525542,0.9648657040832169,0.9666356155876418,0.9666356155876418,0.9683744760130415,0.9631268436578171,0.968390001552554,0.9648657040832169,0.9613569321533924,0.968390001552554,0.9666200900481291,0.9631113181183046,0.9648812296227295,0.9631113181183046,0.968390001552554,0.9648657040832169,0.9561248253376805,0.9648657040832169,0.959633597267505,0.9631113181183046,0.9578636857630801,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.968390001552554,0.95960254618848,0.95960254618848,0.959633597267505,0.9578481602235677,0.9630957925787922,0.9578326346840553,0.968390001552554,0.9666200900481291,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.9648657040832168,0.9596180717279925,0.968390001552554,0.9701443875174661],"type":"scatter","xaxis":"x3","yaxis":"y3"},{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[353,217,679,688,123,799,120,395,107,186,390,383,394,295,515,266,207,259,158,504,282,281,307,483,262,233,161,160,329,156,466,347,185,144,139,130,181,586,112,234,210,140,165,424,105,116,132,100,106,121,752,253,370,147,425,323,236,200,169,596],"y":[0.9666356155876418,0.9490607048594939,0.9648657040832169,0.95960254618848,0.9543393882937432,0.9596180717279925,0.9455364073901567,0.9525694767893184,0.9648657040832168,0.9631268436578171,0.9683900015525542,0.9666200900481291,0.9631113181183046,0.9666356155876418,0.9648657040832169,0.968390001552554,0.9666200900481291,0.9648812296227295,0.9666356155876418,0.9648657040832168,0.9683900015525542,0.9648657040832169,0.9666356155876418,0.9666356155876418,0.9683744760130415,0.9631268436578171,0.968390001552554,0.9648657040832169,0.9613569321533924,0.968390001552554,0.9666200900481291,0.9631113181183046,0.9648812296227295,0.9631113181183046,0.968390001552554,0.9648657040832169,0.9561248253376805,0.9648657040832169,0.959633597267505,0.9631113181183046,0.9578636857630801,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.968390001552554,0.95960254618848,0.95960254618848,0.959633597267505,0.9578481602235677,0.9630957925787922,0.9578326346840553,0.968390001552554,0.9666200900481291,0.9666200900481293,0.9648657040832169,0.9648657040832169,0.9648657040832168,0.9596180717279925,0.968390001552554,0.9701443875174661],"type":"scatter","xaxis":"x4","yaxis":"y4"}],                        {"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,0.2125],"title":{"text":"criterion"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Objective Value"}},"xaxis2":{"anchor":"y2","domain":[0.2625,0.475],"title":{"text":"max_depth"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"matches":"y","showticklabels":false},"xaxis3":{"anchor":"y3","domain":[0.525,0.7375],"title":{"text":"max_features"}},"yaxis3":{"anchor":"x3","domain":[0.0,1.0],"matches":"y","showticklabels":false},"xaxis4":{"anchor":"y4","domain":[0.7875,1.0],"title":{"text":"n_estimators"}},"yaxis4":{"anchor":"x4","domain":[0.0,1.0],"matches":"y","showticklabels":false},"title":{"text":"Slice Plot"},"width":900,"height":400},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('9dde7497-4105-4b30-bd7b-c4eaaeeb42fb');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<p>The default <strong>hyperparameter importance evaluator</strong> in Optuna is <code class="docutils literal notranslate"><span class="pre">FanovaImportanceEvaluator</span></code>. This takes as input performance data gathered with different hyperparameter settings of the algorithm, fits a random forest to capture the relationship between hyperparameters and performance, and then applies functional ANOVA to assess how important each of the hyperparameters and each low-order interaction of hyperparameters is to performance <span id="id5">[<a class="reference internal" href="../intro.html#id2">HHLB14</a>]</span>. From the <a class="reference external" href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.importance.FanovaImportanceEvaluator.html">docs</a>:</p>
<blockquote>
<div><p>The performance of fANOVA depends on the prediction performance of the underlying random forest model. In order to obtain high prediction performance, it is necessary to cover a wide range of the hyperparameter search space. It is recommended to use an exploration-oriented sampler such as <code class="docutils literal notranslate"><span class="pre">RandomSampler</span></code>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_param_importances</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">350</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="d789ccde-4f91-4ef0-822e-83760019a3b2" class="plotly-graph-div" style="height:350px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d789ccde-4f91-4ef0-822e-83760019a3b2")) {                    Plotly.newPlot(                        "d789ccde-4f91-4ef0-822e-83760019a3b2",                        [{"cliponaxis":false,"hovertemplate":["max_features (UniformDistribution): 0.0510181747079005<extra></extra>","n_estimators (IntLogUniformDistribution): 0.1031115716858627<extra></extra>","max_depth (IntLogUniformDistribution): 0.15084724212886497<extra></extra>","criterion (CategoricalDistribution): 0.6950230114773718<extra></extra>"],"marker":{"color":"rgb(66,146,198)"},"orientation":"h","text":["0.0510181747079005","0.1031115716858627","0.15084724212886497","0.6950230114773718"],"textposition":"outside","texttemplate":"%{text:.2f}","x":[0.0510181747079005,0.1031115716858627,0.15084724212886497,0.6950230114773718],"y":["max_features","n_estimators","max_depth","criterion"],"type":"bar"}],                        {"showlegend":false,"title":{"text":"Hyperparameter Importances"},"xaxis":{"title":{"text":"Importance for Objective Value"}},"yaxis":{"title":{"text":"Hyperparameter"}},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"width":600,"height":350},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('d789ccde-4f91-4ef0-822e-83760019a3b2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<p>To visualize interactions between any pair of hyperparameters, we can generate <strong>contour plots</strong> where regions of <em>low</em> objective value are darker in color.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;criterion&quot;</span><span class="p">,</span> <span class="s2">&quot;n_estimators&quot;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="576a9825-a178-45c6-9216-77fbcbf22645" class="plotly-graph-div" style="height:500px; width:600px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("576a9825-a178-45c6-9216-77fbcbf22645")) {                    Plotly.newPlot(                        "576a9825-a178-45c6-9216-77fbcbf22645",                        [{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":false,"x":["entropy","gini"],"y":[65.05,100,105,106,107,112,116,120,121,123,130,132,139,140,144,147,156,158,160,161,165,169,181,185,186,200,207,210,217,233,234,236,253,259,262,266,281,282,295,307,323,329,347,353,370,383,390,394,395,424,425,466,483,504,515,586,596,679,688,752,799,833.95],"z":[[null,null],[null,0.959633597267505],[0.968390001552554,null],[0.9578481602235677,null],[0.9648657040832168,null],[null,0.959633597267505],[0.95960254618848,null],[null,0.9455364073901567],[0.9630957925787922,null],[null,0.9543393882937432],[0.9648657040832169,null],[0.95960254618848,null],[0.968390001552554,null],[0.9666200900481293,null],[0.9631113181183046,null],[0.9666200900481293,null],[0.968390001552554,null],[0.9666356155876418,null],[0.9648657040832169,null],[0.968390001552554,null],[0.9648657040832169,null],[0.968390001552554,null],[null,0.9561248253376805],[0.9648812296227295,null],[null,0.9631268436578171],[null,0.9596180717279925],[0.9666200900481291,null],[null,0.9578636857630801],[null,0.9490607048594939],[0.9631268436578171,null],[0.9631113181183046,null],[0.9648657040832168,null],[0.968390001552554,null],[0.9648812296227295,null],[0.9683744760130415,null],[0.968390001552554,null],[0.9648657040832169,null],[0.9683900015525542,null],[0.9666356155876418,null],[0.9666356155876418,null],[0.9648657040832169,null],[0.9613569321533924,null],[0.9631113181183046,null],[0.9666356155876418,null],[0.9666200900481291,null],[0.9666200900481291,null],[0.9683900015525542,null],[0.9631113181183046,null],[null,0.9525694767893184],[0.9648657040832169,null],[0.9648657040832169,null],[0.9666200900481291,null],[0.9666356155876418,null],[0.9648657040832168,null],[0.9648657040832169,null],[0.9648657040832169,null],[0.9701443875174661,null],[0.9648657040832169,null],[null,0.95960254618848],[0.9578326346840553,null],[null,0.9596180717279925],[null,null]],"type":"contour"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":["entropy","gini","entropy","gini","gini","gini","gini","gini","entropy","gini","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","gini","entropy","gini","entropy","gini","entropy","entropy","entropy","entropy","entropy","entropy","gini","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","entropy","gini","entropy","entropy"],"y":[353,217,679,688,123,799,120,395,107,186,390,383,394,295,515,266,207,259,158,504,282,281,307,483,262,233,161,160,329,156,466,347,185,144,139,130,181,586,112,234,210,140,165,424,105,116,132,100,106,121,752,253,370,147,425,323,236,200,169,596],"type":"scatter"}],                        {"title":{"text":"Contour Plot"},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"title":{"text":"criterion"},"range":[-0.05,1.05],"type":"category"},"yaxis":{"title":{"text":"n_estimators"},"range":[65.05,833.95]},"width":600,"height":500},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('576a9825-a178-45c6-9216-77fbcbf22645');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
</div>
</div>
<div class="section" id="neural-networks">
<h2>Neural networks<a class="headerlink" href="#neural-networks" title="Permalink to this headline">¬∂</a></h2>
<p>As noted above, we should always perform tuning within a cross-validation framework. However, with neural networks, doing 5-fold CV would require too much compute time ‚Äî hence, too much resources, e.g. GPU usage. Instead, we perform tuning on a hold-out validation set and hope for the best.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="kn">import</span> <span class="nn">torchvision.datasets</span> <span class="k">as</span> <span class="nn">datasets</span>
<span class="kn">from</span> <span class="nn">torch.utils</span> <span class="kn">import</span> <span class="n">data</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">optuna</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">PATIENCE</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Define a convolutional network with a smaller version of the VGG architecture.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://d2l.ai/chapter_convolutional-modern/vgg.html</span>

<span class="k">def</span> <span class="nf">vgg_block</span><span class="p">(</span><span class="n">num_convs</span><span class="p">,</span> <span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">):</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_convs</span><span class="p">):</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span>
                                <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">())</span>
        <span class="n">in_channels</span> <span class="o">=</span> <span class="n">out_channels</span>
    <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">vgg</span><span class="p">(</span><span class="n">conv_arch</span><span class="p">,</span> <span class="n">linear_width</span><span class="p">,</span> <span class="n">dropout</span><span class="p">,</span> <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">conv_blks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># The convolutional part</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">num_convs</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">)</span> <span class="ow">in</span> <span class="n">conv_arch</span><span class="p">:</span>
        <span class="n">conv_blks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vgg_block</span><span class="p">(</span><span class="n">num_convs</span><span class="p">,</span> <span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">))</span>
        <span class="n">in_channels</span> <span class="o">=</span> <span class="n">out_channels</span>

    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span>
    <span class="n">dense_layers</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool2d</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">)),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">out_channels</span> <span class="o">*</span> <span class="n">height</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="n">linear_width</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">linear_width</span><span class="p">,</span> <span class="n">linear_width</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">linear_width</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">conv_blks</span> <span class="o">+</span> <span class="n">dense_layers</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We also define a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> class for CIFAR-10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="p">[</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()]</span>
<span class="k">if</span> <span class="n">CIFAR10_RESIZE</span><span class="p">:</span>
    <span class="n">transform</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">CIFAR10_RESIZE</span><span class="p">))</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>

<span class="n">mnist_train</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mnist_valid</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_cifar10_dataloaders</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">sample_ratio</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="n">train_loader</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">mnist_train</span><span class="p">,</span> 
                                   <span class="n">batch_size</span><span class="p">,</span> 
                                   <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                   <span class="n">sampler</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mnist_train</span><span class="p">)</span><span class="o">*</span><span class="n">sample_ratio</span><span class="p">)))</span>
    
    <span class="n">valid_loader</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">mnist_valid</span><span class="p">,</span> 
                                   <span class="n">batch_size</span><span class="p">,</span> 
                                   <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                   <span class="n">sampler</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mnist_valid</span><span class="p">)</span><span class="o">*</span><span class="n">sample_ratio</span><span class="p">)))</span>
    
    <span class="k">return</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">valid_loader</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./cifar-10-python.tar.gz
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f526ee1acb344c17a1fa5c35271c0255", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Extracting ./cifar-10-python.tar.gz to .
Files already downloaded and verified
</pre></div>
</div>
</div>
</div>
<p>Define a trainer for the neural network model. This will handle all loss and metric evaluation, as well as backpropagation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Engine</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Facilitate neural network training and evaluation.&quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span> 

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">loss_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_loader</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Train model on one epoch. Return train loss.&quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_loader</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
            <span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">long</span><span class="p">()</span>
            
            <span class="c1"># Forward pass</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">J</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
            
            <span class="c1"># Backward pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">J</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="c1"># Cumulative loss</span>
            <span class="n">loss</span> <span class="o">+=</span> <span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">-</span> <span class="n">loss</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">loss</span>


    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_loader</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return validation loss and validation accuracy.&quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">num_correct</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_loader</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
                <span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
                
                <span class="c1"># Forward pass</span>
                <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">J</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># Cumulative metrics</span>
                <span class="n">loss</span> <span class="o">+=</span> <span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">-</span> <span class="n">loss</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">num_correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">preds</span> <span class="o">==</span> <span class="n">targets</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
                <span class="n">num_samples</span> <span class="o">+=</span> <span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">acc</span> <span class="o">=</span> <span class="n">num_correct</span> <span class="o">/</span> <span class="n">num_samples</span>
        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">acc</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pruning-based-on-intermediate-values">
<h3>Pruning based on intermediate values<a class="headerlink" href="#pruning-based-on-intermediate-values" title="Permalink to this headline">¬∂</a></h3>
<p>Finally, we set up the <code class="docutils literal notranslate"><span class="pre">study</span></code> instance and its objective function. Note that the search space is dynamically constructed depending on the number of layers (i.e. an earlier suggestion for a hyperparameter). During training, we perform early stopping on validation loss. If no new minimum val. loss is found after 5 epochs, then the minimum val. loss is returned as the objective <a class="footnote-reference brackets" href="#ref3" id="id6">2</a>.</p>
<p>Computing intermediate values allow us to <strong>prune</strong> unpromising trials to conserve resources. The default pruner in Optuna is <a class="reference external" href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.pruners.MedianPruner.html"><code class="docutils literal notranslate"><span class="pre">MedianPruner</span></code></a> which prunes a trial if its best intermediate result as of the current step (e.g. current best valid loss) is worse than the median of all intermediate results of previous trials <em>at the current step</em>. Hence, the best intermediate result of a pruned trial is less than the best intermediate result of 1/2 of the other trials as of that step. In our case, if the minimum validation loss does not improve too quickly, then the trial is pruned. Of course, the validation loss could descend rapidly at later steps, but the median pruner does not bet on this happening.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_training</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">valid_loader</span><span class="p">,</span> <span class="n">engine</span><span class="p">):</span>
    <span class="c1"># Run training</span>
    <span class="n">best_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="n">patience</span> <span class="o">=</span> <span class="n">PATIENCE</span>
    <span class="n">loop</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">EPOCHS</span><span class="p">),</span> <span class="n">total</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">loop</span><span class="p">:</span>

        <span class="c1"># Train and validation step</span>
        <span class="n">train_loss</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
        <span class="n">valid_loss</span><span class="p">,</span> <span class="n">valid_acc</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">valid_loader</span><span class="p">)</span>
            
        <span class="c1"># Early stopping</span>
        <span class="k">if</span> <span class="n">valid_loss</span> <span class="o">&lt;</span> <span class="n">best_loss</span><span class="p">:</span>
            <span class="n">best_loss</span> <span class="o">=</span> <span class="n">valid_loss</span>
            <span class="n">patience</span> <span class="o">=</span> <span class="n">PATIENCE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">patience</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">patience</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
    
        <span class="c1"># Pruning unpromising trials</span>
        <span class="n">trial</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">valid_loss</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">epoch</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">trial</span><span class="o">.</span><span class="n">should_prune</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">optuna</span><span class="o">.</span><span class="n">TrialPruned</span><span class="p">()</span>
            
        <span class="n">loop</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Epoch [</span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">EPOCHS</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="n">loop</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">(</span>
            <span class="n">val_loss</span><span class="o">=</span><span class="n">valid_loss</span><span class="p">,</span> 
            <span class="n">acc</span><span class="o">=</span><span class="n">valid_acc</span><span class="p">,</span> 
            <span class="n">patience</span><span class="o">=</span><span class="n">patience</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="n">engine</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;lr&#39;</span><span class="p">])</span>
        
    <span class="k">return</span> <span class="n">best_loss</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="c1"># Setup model architecture</span>
    <span class="n">conv_arch</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vgg_b1&quot;</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vgg_b2&quot;</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vgg_b3&quot;</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
    <span class="p">]</span>
    <span class="n">dense_width</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;dense&quot;</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dropout</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;dropout&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">learning_rate</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;lr&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Initialize engine</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">vgg</span><span class="p">(</span><span class="n">conv_arch</span><span class="p">,</span> <span class="n">dense_width</span><span class="p">,</span> <span class="n">dropout</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>    
    <span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">DEVICE</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">)</span>
    
    <span class="c1"># Initalize data loaders</span>
    <span class="n">train_loader</span><span class="p">,</span> <span class="n">valid_loader</span> <span class="o">=</span> <span class="n">get_cifar10_dataloaders</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">sample_ratio</span><span class="o">=</span><span class="n">CIFAR10_SAMPLE_RATIO</span><span class="p">)</span>
    
    <span class="c1"># Start training run</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">run_training</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">valid_loader</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">score</span>
</pre></div>
</div>
</div>
</div>
<p>This study looks rather complicated, with a lot of moving parts. We can test the objective using a <code class="docutils literal notranslate"><span class="pre">FixedTrial</span></code> which suggests fixed parameter values based on a given dictionary of parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trial</span> <span class="o">=</span> <span class="n">FixedTrial</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
<span class="n">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span> 
</pre></div>
</div>
<p>We now create the minimization problem with median pruner. The parameters of the pruner will be explained below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pruner</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">pruners</span><span class="o">.</span><span class="n">MedianPruner</span><span class="p">(</span><span class="n">n_startup_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_warmup_steps</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">n_min_trials</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;minimize&quot;</span><span class="p">,</span> <span class="n">pruner</span><span class="o">=</span><span class="n">pruner</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="n">VGG_NTRIALS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">[I 2022-01-09 16:47:49,141]</span> A new study created in memory with name: no-name-78b4e217-1a91-4764-8134-993f98d3cea7
<span class=" -Color -Color-Green">[I 2022-01-09 16:54:25,197]</span> Trial 0 finished with value: 0.9663325294852255 and parameters: {&#39;vgg_b1&#39;: 310, &#39;vgg_b2&#39;: 162, &#39;vgg_b3&#39;: 289, &#39;dense&#39;: 598, &#39;dropout&#39;: 0.1, &#39;lr&#39;: 5.8571334191863526e-05, &#39;batch_size&#39;: 124}. Best is trial 0 with value: 0.9663325294852255.
<span class=" -Color -Color-Green">[I 2022-01-09 17:01:53,776]</span> Trial 1 finished with value: 0.8538003005400426 and parameters: {&#39;vgg_b1&#39;: 258, &#39;vgg_b2&#39;: 247, &#39;vgg_b3&#39;: 206, &#39;dense&#39;: 402, &#39;dropout&#39;: 0.7000000000000001, &#39;lr&#39;: 5.986375901071346e-05, &#39;batch_size&#39;: 42}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 17:06:12,651]</span> Trial 2 finished with value: 0.9333370736837385 and parameters: {&#39;vgg_b1&#39;: 249, &#39;vgg_b2&#39;: 160, &#39;vgg_b3&#39;: 291, &#39;dense&#39;: 960, &#39;dropout&#39;: 0.5, &#39;lr&#39;: 9.652575464574833e-05, &#39;batch_size&#39;: 20}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 17:07:29,117]</span> Trial 3 finished with value: 2.308023227112635 and parameters: {&#39;vgg_b1&#39;: 217, &#39;vgg_b2&#39;: 198, &#39;vgg_b3&#39;: 232, &#39;dense&#39;: 508, &#39;dropout&#39;: 0.7000000000000001, &#39;lr&#39;: 0.09329797140131525, &#39;batch_size&#39;: 89}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 17:12:05,098]</span> Trial 4 finished with value: 0.9594035801822195 and parameters: {&#39;vgg_b1&#39;: 372, &#39;vgg_b2&#39;: 468, &#39;vgg_b3&#39;: 230, &#39;dense&#39;: 733, &#39;dropout&#39;: 0.2, &#39;lr&#39;: 0.00010174140869152476, &#39;batch_size&#39;: 68}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 17:15:52,590]</span> Trial 5 finished with value: 2.3308440674943625 and parameters: {&#39;vgg_b1&#39;: 463, &#39;vgg_b2&#39;: 429, &#39;vgg_b3&#39;: 234, &#39;dense&#39;: 665, &#39;dropout&#39;: 0.30000000000000004, &#39;lr&#39;: 0.13353412052488867, &#39;batch_size&#39;: 18}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 17:17:23,245]</span> Trial 6 finished with value: 2.304749325097323 and parameters: {&#39;vgg_b1&#39;: 208, &#39;vgg_b2&#39;: 216, &#39;vgg_b3&#39;: 346, &#39;dense&#39;: 391, &#39;dropout&#39;: 0.8, &#39;lr&#39;: 0.013848177485291456, &#39;batch_size&#39;: 30}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 17:27:29,422]</span> Trial 7 finished with value: 0.9173180745775198 and parameters: {&#39;vgg_b1&#39;: 370, &#39;vgg_b2&#39;: 351, &#39;vgg_b3&#39;: 285, &#39;dense&#39;: 648, &#39;dropout&#39;: 0.30000000000000004, &#39;lr&#39;: 1.9999878982282223e-05, &#39;batch_size&#39;: 17}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 17:48:59,758]</span> Trial 8 finished with value: 0.970559313589213 and parameters: {&#39;vgg_b1&#39;: 399, &#39;vgg_b2&#39;: 223, &#39;vgg_b3&#39;: 308, &#39;dense&#39;: 259, &#39;dropout&#39;: 0.7000000000000001, &#39;lr&#39;: 1.3064656747928878e-05, &#39;batch_size&#39;: 51}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 17:50:51,638]</span> Trial 9 finished with value: 2.1159408791311862 and parameters: {&#39;vgg_b1&#39;: 506, &#39;vgg_b2&#39;: 277, &#39;vgg_b3&#39;: 336, &#39;dense&#39;: 355, &#39;dropout&#39;: 0.6, &#39;lr&#39;: 0.01014034214456914, &#39;batch_size&#39;: 85}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 17:52:17,641]</span> Trial 10 finished with value: 2.3026118452185833 and parameters: {&#39;vgg_b1&#39;: 137, &#39;vgg_b2&#39;: 292, &#39;vgg_b3&#39;: 151, &#39;dense&#39;: 404, &#39;dropout&#39;: 1.0, &#39;lr&#39;: 0.0007539244254643046, &#39;batch_size&#39;: 33}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 18:08:07,878]</span> Trial 11 finished with value: 0.8779827433663444 and parameters: {&#39;vgg_b1&#39;: 314, &#39;vgg_b2&#39;: 358, &#39;vgg_b3&#39;: 464, &#39;dense&#39;: 500, &#39;dropout&#39;: 0.4, &#39;lr&#39;: 1.359546850655156e-05, &#39;batch_size&#39;: 27}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 18:12:25,817]</span> Trial 12 finished with value: 0.9928599794705705 and parameters: {&#39;vgg_b1&#39;: 286, &#39;vgg_b2&#39;: 351, &#39;vgg_b3&#39;: 510, &#39;dense&#39;: 481, &#39;dropout&#39;: 0.5, &#39;lr&#39;: 0.00030648865735273913, &#39;batch_size&#39;: 32}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 18:16:12,951]</span> Trial 13 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 18:20:18,070]</span> Trial 14 finished with value: 2.3027173531055456 and parameters: {&#39;vgg_b1&#39;: 307, &#39;vgg_b2&#39;: 136, &#39;vgg_b3&#39;: 484, &#39;dense&#39;: 450, &#39;dropout&#39;: 0.4, &#39;lr&#39;: 0.0019107435528946583, &#39;batch_size&#39;: 25}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 18:24:20,313]</span> Trial 15 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 18:28:34,995]</span> Trial 16 finished with value: 0.9710360651466702 and parameters: {&#39;vgg_b1&#39;: 183, &#39;vgg_b2&#39;: 392, &#39;vgg_b3&#39;: 417, &#39;dense&#39;: 806, &#39;dropout&#39;: 0.4, &#39;lr&#39;: 0.0004394672803314361, &#39;batch_size&#39;: 23}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 18:34:13,305]</span> Trial 17 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 18:37:54,311]</span> Trial 18 finished with value: 0.9328236542642117 and parameters: {&#39;vgg_b1&#39;: 339, &#39;vgg_b2&#39;: 318, &#39;vgg_b3&#39;: 139, &#39;dense&#39;: 468, &#39;dropout&#39;: 0.4, &#39;lr&#39;: 0.00024037964468769132, &#39;batch_size&#39;: 39}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 18:49:09,175]</span> Trial 19 finished with value: 0.8594228555448353 and parameters: {&#39;vgg_b1&#39;: 424, &#39;vgg_b2&#39;: 244, &#39;vgg_b3&#39;: 407, &#39;dense&#39;: 415, &#39;dropout&#39;: 0.7000000000000001, &#39;lr&#39;: 3.136450432363738e-05, &#39;batch_size&#39;: 26}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 18:54:58,491]</span> Trial 20 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 19:00:02,795]</span> Trial 21 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 19:07:12,185]</span> Trial 22 finished with value: 0.9695012574436284 and parameters: {&#39;vgg_b1&#39;: 340, &#39;vgg_b2&#39;: 295, &#39;vgg_b3&#39;: 441, &#39;dense&#39;: 546, &#39;dropout&#39;: 0.8, &#39;lr&#39;: 0.000132589105195643, &#39;batch_size&#39;: 21}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 19:10:58,123]</span> Trial 23 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 19:17:36,122]</span> Trial 24 finished with value: 0.8793295427244536 and parameters: {&#39;vgg_b1&#39;: 231, &#39;vgg_b2&#39;: 197, &#39;vgg_b3&#39;: 206, &#39;dense&#39;: 435, &#39;dropout&#39;: 0.5, &#39;lr&#39;: 6.046048370778813e-05, &#39;batch_size&#39;: 51}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 19:21:41,670]</span> Trial 25 finished with value: 2.302633065572926 and parameters: {&#39;vgg_b1&#39;: 327, &#39;vgg_b2&#39;: 272, &#39;vgg_b3&#39;: 450, &#39;dense&#39;: 287, &#39;dropout&#39;: 0.9, &#39;lr&#39;: 0.0009895984157195427, &#39;batch_size&#39;: 35}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 19:25:13,284]</span> Trial 26 finished with value: 0.9796114992436178 and parameters: {&#39;vgg_b1&#39;: 382, &#39;vgg_b2&#39;: 317, &#39;vgg_b3&#39;: 265, &#39;dense&#39;: 519, &#39;dropout&#39;: 0.30000000000000004, &#39;lr&#39;: 0.00016720140088459775, &#39;batch_size&#39;: 23}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 19:31:49,340]</span> Trial 27 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 19:33:56,756]</span> Trial 28 finished with value: 2.3033253585591025 and parameters: {&#39;vgg_b1&#39;: 195, &#39;vgg_b2&#39;: 235, &#39;vgg_b3&#39;: 379, &#39;dense&#39;: 608, &#39;dropout&#39;: 0.6, &#39;lr&#39;: 0.006701555276590694, &#39;batch_size&#39;: 42}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 19:39:05,950]</span> Trial 29 finished with value: 1.0034908101309177 and parameters: {&#39;vgg_b1&#39;: 301, &#39;vgg_b2&#39;: 393, &#39;vgg_b3&#39;: 471, &#39;dense&#39;: 580, &#39;dropout&#39;: 0.1, &#39;lr&#39;: 5.5809854563142486e-05, &#39;batch_size&#39;: 29}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 19:42:07,542]</span> Trial 30 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 19:47:44,125]</span> Trial 31 finished with value: 0.8815758077495073 and parameters: {&#39;vgg_b1&#39;: 231, &#39;vgg_b2&#39;: 186, &#39;vgg_b3&#39;: 208, &#39;dense&#39;: 426, &#39;dropout&#39;: 0.5, &#39;lr&#39;: 6.388393481294276e-05, &#39;batch_size&#39;: 60}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 19:52:07,526]</span> Trial 32 finished with value: 0.874182585053719 and parameters: {&#39;vgg_b1&#39;: 161, &#39;vgg_b2&#39;: 205, &#39;vgg_b3&#39;: 197, &#39;dense&#39;: 440, &#39;dropout&#39;: 0.5, &#39;lr&#39;: 7.930129805507095e-05, &#39;batch_size&#39;: 48}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 19:54:49,195]</span> Trial 33 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 19:58:08,657]</span> Trial 34 finished with value: 0.8615798228979111 and parameters: {&#39;vgg_b1&#39;: 129, &#39;vgg_b2&#39;: 260, &#39;vgg_b3&#39;: 244, &#39;dense&#39;: 1019, &#39;dropout&#39;: 0.6, &#39;lr&#39;: 0.00010372443791344133, &#39;batch_size&#39;: 50}. Best is trial 1 with value: 0.8538003005400426.
<span class=" -Color -Color-Green">[I 2022-01-09 20:02:53,732]</span> Trial 35 finished with value: 0.8468572935637306 and parameters: {&#39;vgg_b1&#39;: 138, &#39;vgg_b2&#39;: 141, &#39;vgg_b3&#39;: 250, &#39;dense&#39;: 852, &#39;dropout&#39;: 0.7000000000000001, &#39;lr&#39;: 9.058519215325063e-05, &#39;batch_size&#39;: 49}. Best is trial 35 with value: 0.8468572935637306.
<span class=" -Color -Color-Green">[I 2022-01-09 20:04:00,344]</span> Trial 36 finished with value: 2.3064591855887904 and parameters: {&#39;vgg_b1&#39;: 130, &#39;vgg_b2&#39;: 147, &#39;vgg_b3&#39;: 255, &#39;dense&#39;: 1016, &#39;dropout&#39;: 0.8, &#39;lr&#39;: 0.037906633402615846, &#39;batch_size&#39;: 60}. Best is trial 35 with value: 0.8468572935637306.
<span class=" -Color -Color-Green">[I 2022-01-09 20:07:30,138]</span> Trial 37 pruned. 
<span class=" -Color -Color-Green">[I 2022-01-09 20:10:06,667]</span> Trial 38 finished with value: 0.9325450231631596 and parameters: {&#39;vgg_b1&#39;: 145, &#39;vgg_b2&#39;: 152, &#39;vgg_b3&#39;: 225, &#39;dense&#39;: 916, &#39;dropout&#39;: 0.7000000000000001, &#39;lr&#39;: 0.0003701946567741201, &#39;batch_size&#39;: 83}. Best is trial 35 with value: 0.8468572935637306.
<span class=" -Color -Color-Green">[I 2022-01-09 20:12:17,309]</span> Trial 39 finished with value: 1.0199463226821985 and parameters: {&#39;vgg_b1&#39;: 130, &#39;vgg_b2&#39;: 180, &#39;vgg_b3&#39;: 274, &#39;dense&#39;: 743, &#39;dropout&#39;: 0.6, &#39;lr&#39;: 0.0006663982177439894, &#39;batch_size&#39;: 56}. Best is trial 35 with value: 0.8468572935637306.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">optuna.trial</span> <span class="kn">import</span> <span class="n">TrialState</span>

<span class="n">pruned_trials</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">get_trials</span><span class="p">(</span><span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="n">TrialState</span><span class="o">.</span><span class="n">PRUNED</span><span class="p">])</span>
<span class="n">complete_trials</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">get_trials</span><span class="p">(</span><span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="n">TrialState</span><span class="o">.</span><span class="n">COMPLETE</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Study statistics: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Number of finished trials:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Number of pruned trials:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pruned_trials</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Number of complete trials:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">complete_trials</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Best trial:&quot;</span><span class="p">)</span>
<span class="n">best_trial</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Value: &quot;</span><span class="p">,</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Params: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Study statistics: 
  Number of finished trials:	 40
  Number of pruned trials:	 10
  Number of complete trials:	 30

Best trial:
  Value:  0.8468572935637306
  Params: 
    vgg_b1: 138
    vgg_b2: 141
    vgg_b3: 250
    dense: 852
    dropout: 0.7000000000000001
    lr: 9.058519215325063e-05
    batch_size: 49
</pre></div>
</div>
</div>
</div>
<p>Trials either early stops (gradient descent loses momentum) or gets pruned (expected to not improve even if gradient descent continues). Pruning starts after 10 trials are completed, i.e. <code class="docutils literal notranslate"><span class="pre">n_startup_trials=10</span></code>. This is so that the pruner obtains enough information about the general behavior of the gradient descent optimizer before starting to prune.</p>
<p>We set <code class="docutils literal notranslate"><span class="pre">n_warmup_steps=15</span></code> allowing each trial to train the network for 16 epochs before pruning, so that the completed trials will not be dominated by networks that descend quickly, but to shallow minimas. For example, shallow networks that possibly overfits the validation set. However, this comes at the price of wasting resources for training 16 epochs for around half of the number of trials. Finally, we set <code class="docutils literal notranslate"><span class="pre">n_min_trials=5</span></code> so that a higher number of trials at later steps can continue until it early stops or reaches max epochs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_intermediate_values</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="1ea48eba-c655-4ad0-8f10-c9d3e117daec" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("1ea48eba-c655-4ad0-8f10-c9d3e117daec")) {                    Plotly.newPlot(                        "1ea48eba-c655-4ad0-8f10-c9d3e117daec",                        [{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial0","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],"y":[1.8353351920843124,1.6574679315090184,1.501542404294014,1.4057896643877028,1.336867317557335,1.276524329185486,1.233667877316475,1.1947572499513626,1.1635576173663134,1.1291352838277815,1.1173873111605646,1.0654243275523188,1.0467413723468781,1.033348616957665,1.0185001239180562,1.0088388741016385,1.0149000674486162,0.9732727289199827,0.9785592272877693,0.972210593521595,0.9865359112620353,0.9839140474796294,0.9769311219453811,0.9694834828376773,0.9663325294852255,0.9829732924699782,0.9864037930965421,0.9783063843846321,0.9706373527646065],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial1","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"y":[1.9804246205241742,1.7201936485386693,1.6203289112123118,1.501477698318097,1.397656140207242,1.279518200569794,1.2419819536329317,1.1629529269803474,1.1229288092180465,1.0709353750493338,1.0740707261221747,1.0251890250614712,1.0250438566969224,0.9931125305279962,0.9460745003043103,0.935003149409254,0.9481330754376261,0.9381256636952152,0.9306100101030171,0.9212293073910626,0.8812755909787505,0.9104762545653752,0.887316238479454,0.9142003099457556,0.9212890577917338,0.8742876233173019,0.8538003005400426,0.8705411147670583,0.8623282130525894,0.9477693405972808,0.9244539990645496],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial2","x":[0,1,2,3,4,5,6,7,8,9,10,11,12],"y":[1.6108411135673522,1.3460712122917173,1.2490370261669166,1.1356685345172886,1.0555508294105531,1.037994417309761,0.9850502943992615,0.9750709784030914,0.9333370736837385,0.95479379594326,0.9760574819445613,0.9836852404475209,1.0254167991578578],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial3","x":[0,1,2,3,4],"y":[2.308023227112635,2.309804558753967,2.310357366289412,2.310729942151478,2.311347092900958],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial4","x":[0,1,2,3,4,5,6,7,8,9,10,11,12],"y":[1.6424561983918486,1.4862269457072426,1.306044228272895,1.22420542289133,1.1551624242573566,1.0799314396022113,0.9989184998486138,0.982882070214781,0.9594035801822195,0.9814525761016425,1.0501573526695982,0.9770979881286622,1.0656101393373048],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial5","x":[0,1,2,3,4,5,6],"y":[2.334591816478687,2.3359517543324517,2.3308440674943625,2.336061536189879,2.3449334512979116,2.3363438194839525,2.3350422700819986],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial6","x":[0,1,2,3,4],"y":[2.304749325097323,2.3047549264976785,2.3047563124852,2.3047570737011456,2.3047568826790314],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial7","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],"y":[1.730438310272839,1.538725616169624,1.4598647836519762,1.3804395056906207,1.3027279687171085,1.2337852132563687,1.1856886918852927,1.1776156348436064,1.1432467151661316,1.088967964154523,1.0598896267462754,1.030469658423442,0.9982639306864772,1.01568203444789,0.9906121258224766,0.9587041158862667,0.9480646617558535,0.9272540720547138,0.9173180745775198,0.9323956062193633,0.924037140800434,0.9362594674841881,0.9285688325255906],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial8","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81],"y":[2.1548718335677175,2.0590237525044652,1.9447801538876128,1.8546974135904897,1.8151229924085186,1.761288276740483,1.7140278487789398,1.6878569186950212,1.6611541156866116,1.6348107408504107,1.5958229242538913,1.5566814335025088,1.5610713934411804,1.5396753586068446,1.4938992979575183,1.4896965854021964,1.4611216588896152,1.4424195593717146,1.4499363412662425,1.4402594359553587,1.3996735105709153,1.4133146587683232,1.3718620927966372,1.3749853518544408,1.3927942392777424,1.3510659203237427,1.34194743389986,1.3304045686916426,1.3274094875977964,1.288601667905341,1.3107470012440974,1.264324497811648,1.262856535765589,1.2434221116863953,1.2495909089944806,1.230264096235742,1.221627558372459,1.2210433288496365,1.2029831038445842,1.2077942922407265,1.1875767391555156,1.1685687321789409,1.1803976060176378,1.2076023464300198,1.16965240240097,1.168197831937245,1.17398298090818,1.1337465339777422,1.1431393051634027,1.1305044913778501,1.1288254893555933,1.1238237929587462,1.1119957414208623,1.094891551806002,1.0944784964833936,1.0984684405278191,1.087196136615714,1.0819690993853979,1.071408632458473,1.0955069296214046,1.0664455531811226,1.051869459298192,1.0739095344835399,1.0592646866428603,1.0332347616857407,1.0430467615322185,1.0326100660830126,1.0299658501634792,1.0244026214492568,1.0263381576051511,1.0217029549637626,1.0119604857600462,1.0040843158352128,1.0217900038981929,0.997498864422039,0.9849795322028957,0.9922254371399785,0.970559313589213,0.9793571744646346,1.0010380793590934,0.9882688248644066,0.9827555673463002],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial9","x":[0,1,2,3,4,5],"y":[2.222681057864222,2.1159408791311862,2.303680407589879,2.3033243623273116,2.303330257021148,2.303343633125568],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial10","x":[0,1,2,3,4,5],"y":[2.3026347207707283,2.3026118452185833,2.30261567886302,2.3026181404164308,2.302619106722195,2.3026194319819764],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial11","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],"y":[1.853826368821633,1.674285386704109,1.582715131785419,1.5123444827827248,1.445192006149807,1.420923823279303,1.3607372780103943,1.3522066680160731,1.314817735633335,1.2759813553578148,1.2686562154744128,1.2560847089097313,1.1773733122928716,1.1655464062819614,1.1364031798130756,1.1170818251532482,1.1076463692897076,1.0703903111251623,1.0653584738035462,1.037604258028237,1.032418763637543,1.008070931080224,0.9874996871561619,0.9808804418589616,0.9481460880588843,0.9404331912865509,0.9483504844678418,0.9294623155851617,0.9376284568696407,0.9117862506492717,0.9236912790182471,0.9092122693319578,0.9058093675085018,0.9044559984593779,0.8800187648953623,0.8779827433663444,0.907238682379593,0.8881352882127503,0.8910908043384554,0.9062895092609766],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial12","x":[0,1,2,3,4,5,6,7,8,9,10,11,12],"y":[1.635446891570702,1.3963831678414955,1.3095089090176115,1.1589186856379874,1.0755885996115517,1.0388781351920893,0.9941699336736626,1.0290812116402845,0.9928599794705705,1.0659925975860702,1.1472614013995874,1.268964178287066,1.2819829548780732],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial13","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[2.302837027443781,2.2994105970418013,2.277917813371731,2.268575253310028,2.2475833031866292,2.2201494442092056,2.1946405282727,2.1773623802043773,2.15160529701798,2.1455049912134796,2.0972789216924594,2.091478130331745,2.0746038953463226,2.059178783937736,2.0316223954712895,2.0031545029746165],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial14","x":[0,1,2,3,4,5,6,7,8,9,10,11,12],"y":[2.3030287063121797,2.302809208631514,2.302726058959962,2.3027189457416535,2.302717490196228,2.302717704772951,2.302717605829238,2.3027177155017857,2.3027173531055456,2.3027174055576305,2.302717437744141,2.302717437744141,2.302717437744141],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial15","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],"y":[1.910290022850037,1.7494022960662843,1.64696144580841,1.4783430109024052,1.367295958518982,1.3266934194564821,1.2507915091514588,1.2083227009773256,1.1627474074363708,1.1370937161445618,1.12761660861969,1.0763732447624204,1.0714344086647034,1.0553707103729248,1.0340797166824345,1.0063662414550776,1.0063097934722904,0.9821272859573364],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial16","x":[0,1,2,3,4,5,6,7,8,9],"y":[1.507963956775754,1.2494985963891732,1.0813060243558223,1.0315481407851121,0.99530837832508,0.9710360651466702,1.0047775149894755,1.0895276750837048,1.1122493877114235,1.275157563560021],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial17","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[2.1434666140134935,2.155690237533215,2.108176762281463,2.0973044037818913,2.145070404507394,2.094174355961556,2.1266935481581575,2.0765121163323856,2.2524659356405565,1.9166326148565425,1.8787333937578428,1.8305686989495924,1.880721710449041,1.8719867495603342,1.9204630103222164,1.8248113061106483],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial18","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[1.5722987921908496,1.377627427689732,1.1854611514136195,1.0872744657099243,1.0329578821547327,0.9480947460979221,0.9328236542642117,0.9707685529720037,0.9452245440334079,1.0333131586667155,1.0661065918393435],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial19","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],"y":[1.9416469565282266,1.790588308125734,1.5947375390678649,1.4981006210048993,1.4592309929430491,1.3714840201040104,1.2959860072781642,1.2561110860357683,1.2270686763028302,1.1941975513473149,1.1276854518800978,1.092340023256838,1.064542375504971,1.053692102742693,1.0247957194223989,0.9976924013656879,0.966366594657302,0.9680243064649399,0.95307088845099,0.9246404105797406,0.9082321121046943,0.912166077022751,0.9130260511301465,0.9485747770716754,0.8718275753781205,0.8680446889872353,0.8624169616959991,0.868992394922922,0.8594228555448353,0.8675109160443142,0.8785762743403513,0.8738565177967154,0.9009237716284895],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial20","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[2.3027789857652454,2.3027449890419276,2.3027148864887383,2.3026883248929617,2.3026648733350954,2.302644261607417,2.302626258355599,2.3026105668809684,2.302596849865383,2.302585045496624,2.3025749188882347,2.302566212194937,2.302558817686857,2.3025525958449733,2.3025474018520784,2.3025431738959417],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial21","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[1.9337294939905405,1.8123304421703015,1.6245251024762797,1.5440267336865263,1.4483997256805505,1.3918267056966815,1.375396347604691,1.299039124821623,1.251176780710617,1.2104554384325943,1.1744066557536523,1.146366183025142,1.111975388290981,1.1047235885635023,1.075057556852699,1.053359474055469],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial22","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[1.9931067053009495,1.6472083430330293,1.5034141896151696,1.33560062156004,1.235602146186748,1.1202907792660362,1.0675712603480878,1.019169195735155,0.9897190621670554,1.108620406699782,0.9966915953560035,0.9988155092010983,0.9695012574436284,1.0123942037339972,1.0517713203400127,1.0779194377300116,1.1219714551913642],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial23","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[1.8953408833300132,1.7715451811136838,1.6734907982054725,1.5891156350628708,1.4668389297603217,1.4531833917907118,1.37289780210913,1.3571680164738997,1.319222351473369,1.2897365927026514,1.2351114207439207,1.215133430247896,1.173979232485375,1.1570436184325912,1.1326224730255898,1.1058365541897466],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial24","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],"y":[1.8051862582868465,1.6434288024902344,1.493923200636494,1.4539936014584136,1.320842941196597,1.2894229079995838,1.2460686077876963,1.1628151931324784,1.1126129724541491,1.0921597067190676,1.0693203521018124,1.0241338045013193,1.0166432760199724,0.9849403640445397,0.9749873462988404,0.9433082962522702,0.9476184224595829,0.9371247431453393,0.9142736610101196,0.9383244021814695,0.9170982928908601,0.880836989198412,0.887535480212192,0.8793295427244536,0.8955092959258021,0.9143434325043034,0.9299327551710362,0.9321065855269534],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial25","x":[0,1,2,3,4,5,6,7,8,9,10,11],"y":[2.30277569361136,2.3027057261534125,2.3026843742585528,2.302667918339582,2.302658779520384,2.30267198992447,2.302650841189103,2.302633065572926,2.3026626748098455,2.3026478575988563,2.3026437977669936,2.3026496222321415],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial26","x":[0,1,2,3,4,5,6,7,8],"y":[1.4629451797305164,1.3109807512177853,1.150944711425887,1.0308939781606477,0.9796114992436178,0.9925347923683124,1.020958641981749,1.0530822430887525,1.077583100114549],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial27","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[1.9976999534246254,1.8259357511997223,1.7288399541225188,1.6272255304532186,1.53521579083724,1.4704378690475066,1.4191581923992198,1.3792631104588502,1.3639117710483384,1.3508807573563013,1.3108264158169425,1.2732702721005842,1.2729347678713319,1.2623891511406644,1.1736270972551444,1.1866263559995545],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial28","x":[0,1,2,3,4,5,6,7],"y":[2.303479911900368,2.303338874287967,2.3033295799704154,2.3033253585591025,2.3033255468897456,2.3033258814771633,2.303326789070577,2.303326103867604],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial29","x":[0,1,2,3,4,5,6,7,8,9,10,11],"y":[1.5594750788322722,1.3460217100936314,1.2365997797527977,1.1739401415336967,1.0851541889268297,1.055258170463318,1.0152541963860042,1.0034908101309177,1.024561362557633,1.0426097387491267,1.0947271521354822,1.1867075314701998],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial30","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[2.302498294952067,2.3010622897046673,2.27461824518569,2.243125819145365,2.2130022556223756,2.193897506023976,2.1637674138901084,2.126071767604098,2.111672472446523,2.082638015138342,2.0473900171036417,2.0213118284306635,1.992355131088419,1.9849214046559438,1.953809192840089,1.925133656948171],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial31","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"y":[1.8061550783823768,1.6788142215774717,1.483888654823763,1.4200342074934256,1.328708907207811,1.291917473436838,1.247969434203872,1.1782054305076595,1.1332175853740745,1.0741395849779425,1.0436195752706867,1.0184004378606044,0.9877020228339963,0.9655976755073269,0.957995914551149,0.923381417630667,0.9189981430409901,0.9002097959978033,0.8914250192872012,0.9029372585825175,0.8815758077495073,0.9093479162239169,0.9175676157675595,0.929552384169705,0.8904140526989858],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial32","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1.801017405895086,1.5953737657803757,1.4901647728223064,1.3574315928495846,1.270403843659621,1.2259191601322248,1.1580539414515862,1.0981975169135973,1.0749984538325896,1.0233250667269411,1.0008538262202185,1.002691527398733,0.9454522671607826,0.9330384255601808,0.9064938271274934,0.9238592432095456,0.9229917761224965,0.8805315686533084,0.8986851466962924,0.874182585053719,0.9163980157329484,0.9109386414862598,0.9557077715603206,0.9424720538350252],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial33","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[1.9043675950595313,1.72103328364236,1.625099827562059,1.555604970455169,1.5124992745263237,1.4648886782782418,1.4420994247709,1.4057108879089357,1.345515528747014,1.3319528988429479,1.3134975041661945,1.301662232194628,1.268779340812138,1.2561122706958232,1.217210874387196,1.211425951548985],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial34","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[1.7398267972469332,1.4115770328044892,1.295462960600853,1.1698142910003666,1.0927055680751798,1.0413142526149743,0.9860421967506405,0.9494350582361223,0.8798179244995119,0.8830671167373656,0.8615798228979111,0.9023015856742859,0.8795920449495312,0.9283196502923966,0.9612635016441347],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial35","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],"y":[1.8907713609583237,1.5828456960472406,1.424981895615073,1.3436616320236054,1.2757436387679149,1.1971116346471453,1.1407102732097407,1.0917338267260908,1.0425236119943506,1.053738978563571,0.9864889459282746,0.9774953442461352,0.9574073500492992,0.9565030085105526,0.9074262813025831,0.8689249251403061,0.8820752045687508,0.8603721439254051,0.8468572935637306,0.8846003132707929,0.9193371268464067,0.8921048424991908,0.9076896070265299],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial36","x":[0,1,2,3,4],"y":[2.3064591855887904,2.306787459247083,2.3069173600300243,2.306982712573317,2.307018911982157],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial37","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"y":[1.7768537468380403,1.5459992074304156,1.403730569614304,1.290176558825705,1.1989026044805844,1.1216644148031873,1.0652794448865783,1.0294002617398899,0.9572134547763401,0.996909418867694,0.9754738459984464,0.9373137081662811,0.9289256872402298,1.0059955757525236,0.9823118961519666,0.9274915125634932,0.9434561034043633,0.9510275191730924,0.9893983445233768],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial38","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13],"y":[1.68660860657692,1.4208690325419109,1.2103441804647448,1.1426573028167089,1.0458878080050151,0.990890869498253,0.9815135528643926,0.9845848381519318,0.9350877741972603,0.9325450231631596,0.9390426288048427,0.9483364870150883,0.9908102343479791,1.062893335024516],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial39","x":[0,1,2,3,4,5,6,7,8,9],"y":[1.6269355007771695,1.3970044194982296,1.2211006692286286,1.168702965372064,1.0696838297201008,1.0199463226821985,1.0470712928289778,1.0455194155821639,1.0316026800134204,1.121845630447516],"type":"scatter"}],                        {"showlegend":false,"title":{"text":"Intermediate Values Plot"},"xaxis":{"title":{"text":"Step"}},"yaxis":{"title":{"text":"Intermediate Value"}},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('1ea48eba-c655-4ad0-8f10-c9d3e117daec');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_optimization_history</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="0151f93c-e47c-4804-a6f9-76fdc807a774" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("0151f93c-e47c-4804-a6f9-76fdc807a774")) {                    Plotly.newPlot(                        "0151f93c-e47c-4804-a6f9-76fdc807a774",                        [{"mode":"markers","name":"Objective Value","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,19,22,24,25,26,28,29,31,32,34,35,36,38,39],"y":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985],"type":"scatter"},{"name":"Best Value","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,19,22,24,25,26,28,29,31,32,34,35,36,38,39],"y":[0.9663325294852255,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8538003005400426,0.8468572935637306,0.8468572935637306,0.8468572935637306,0.8468572935637306],"type":"scatter"}],                        {"title":{"text":"Optimization History Plot"},"xaxis":{"title":{"text":"#Trials"}},"yaxis":{"title":{"text":"Objective Value"}},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('0151f93c-e47c-4804-a6f9-76fdc807a774');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<p>We can look at the distribution of best losses. Should have used a higher number of bins!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">trials_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.7/site-packages/seaborn/distributions.py:2619: FutureWarning:

`distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
</pre></div>
</div>
<img alt="../_images/optuna_53_1.png" src="../_images/optuna_53_1.png" />
</div>
</div>
</div>
<div class="section" id="analyzing-hyperparameter-interactions">
<h3>Analyzing hyperparameter interactions<a class="headerlink" href="#analyzing-hyperparameter-interactions" title="Permalink to this headline">¬∂</a></h3>
<p>The parallel coordinate plot below shows which combination of hyperparameters work. We can also use this to select low complexity models with similar performance to the best performance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_parallel_coordinate</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="98ebad1e-0985-4d74-aebb-8246e24ce2b2" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("98ebad1e-0985-4d74-aebb-8246e24ce2b2")) {                    Plotly.newPlot(                        "98ebad1e-0985-4d74-aebb-8246e24ce2b2",                        [{"dimensions":[{"label":"Objective Value","range":[0.8468572935637306,2.3308440674943625],"values":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985]},{"label":"batch_size","range":[17,124],"values":[124,42,20,89,68,18,30,17,51,85,33,27,32,25,23,39,26,21,51,35,23,42,29,60,48,50,49,60,83,56]},{"label":"dense","range":[259,1019],"values":[598,402,960,508,733,665,391,648,259,355,404,500,481,450,806,468,415,546,435,287,519,608,580,426,440,1019,852,1016,916,743]},{"label":"dropout","range":[0.1,1.0],"values":[0.1,0.7000000000000001,0.5,0.7000000000000001,0.2,0.30000000000000004,0.8,0.30000000000000004,0.7000000000000001,0.6,1.0,0.4,0.5,0.4,0.4,0.4,0.7000000000000001,0.8,0.5,0.9,0.30000000000000004,0.6,0.1,0.5,0.5,0.6,0.7000000000000001,0.8,0.7000000000000001,0.6]},{"label":"lr","range":[-4.883901996150103,-0.8744077495628464],"ticktext":["1.31e-05","0.0001","0.001","0.01","0.1","0.134"],"tickvals":[-4.883901996150103,-4,-3,-2,-1,-0.8744077495628464],"values":[-4.232314883099159,-4.222836016089979,-4.015356794343093,-1.0301277991130147,-3.992502253507096,-0.8744077495628464,-1.8586073789578546,-4.698972632210322,-4.883901996150103,-1.993947391255981,-3.1226721862904565,-4.866605821816518,-3.5135855933813476,-2.7187975971084195,-3.3570734539246385,-3.619102311103973,-4.50356157154798,-3.8774921603038206,-4.218528382616639,-3.004541008654614,-3.7767600881774936,-2.173824395857809,-4.253289109225088,-4.194608342143448,-4.100719703810508,-3.984118909950445,-4.042942790090676,-1.4212847848057266,-3.4315698539522717,-3.176266173103348]},{"label":"vgg_b1","range":[129,506],"values":[310,258,249,217,372,463,208,370,399,506,137,314,286,307,183,339,424,340,231,327,382,195,301,231,161,129,138,130,145,130]},{"label":"vgg_b2","range":[136,468],"values":[162,247,160,198,468,429,216,351,223,277,292,358,351,136,392,318,244,295,197,272,317,235,393,186,205,260,141,147,152,180]},{"label":"vgg_b3","range":[139,510],"values":[289,206,291,232,230,234,346,285,308,336,151,464,510,484,417,139,407,441,206,450,265,379,471,208,197,244,250,255,225,274]}],"labelangle":30,"labelside":"bottom","line":{"color":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985],"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"reversescale":true,"showscale":true},"type":"parcoords"}],                        {"title":{"text":"Parallel Coordinate Plot"},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('98ebad1e-0985-4d74-aebb-8246e24ce2b2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_slice</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="dfa582df-5007-44f3-9728-8fece300a32e" class="plotly-graph-div" style="height:450px; width:1200px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("dfa582df-5007-44f3-9728-8fece300a32e")) {                    Plotly.newPlot(                        "dfa582df-5007-44f3-9728-8fece300a32e",                        [{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,19,22,24,25,26,28,29,31,32,34,35,36,38,39],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":true},"mode":"markers","showlegend":false,"x":[124,42,20,89,68,18,30,17,51,85,33,27,32,25,23,39,26,21,51,35,23,42,29,60,48,50,49,60,83,56],"y":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985],"type":"scatter","xaxis":"x","yaxis":"y"},{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,19,22,24,25,26,28,29,31,32,34,35,36,38,39],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[598,402,960,508,733,665,391,648,259,355,404,500,481,450,806,468,415,546,435,287,519,608,580,426,440,1019,852,1016,916,743],"y":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,19,22,24,25,26,28,29,31,32,34,35,36,38,39],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[0.1,0.7000000000000001,0.5,0.7000000000000001,0.2,0.30000000000000004,0.8,0.30000000000000004,0.7000000000000001,0.6,1.0,0.4,0.5,0.4,0.4,0.4,0.7000000000000001,0.8,0.5,0.9,0.30000000000000004,0.6,0.1,0.5,0.5,0.6,0.7000000000000001,0.8,0.7000000000000001,0.6],"y":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985],"type":"scatter","xaxis":"x3","yaxis":"y3"},{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,19,22,24,25,26,28,29,31,32,34,35,36,38,39],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[0.000058571334191863526,0.00005986375901071346,0.00009652575464574833,0.09329797140131525,0.00010174140869152476,0.13353412052488867,0.013848177485291456,0.000019999878982282223,0.000013064656747928878,0.01014034214456914,0.0007539244254643046,0.00001359546850655156,0.00030648865735273913,0.0019107435528946583,0.0004394672803314361,0.00024037964468769132,0.00003136450432363738,0.000132589105195643,0.00006046048370778813,0.0009895984157195427,0.00016720140088459775,0.006701555276590694,0.000055809854563142486,0.00006388393481294276,0.00007930129805507095,0.00010372443791344133,0.00009058519215325063,0.037906633402615846,0.0003701946567741201,0.0006663982177439894],"y":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985],"type":"scatter","xaxis":"x4","yaxis":"y4"},{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,19,22,24,25,26,28,29,31,32,34,35,36,38,39],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[310,258,249,217,372,463,208,370,399,506,137,314,286,307,183,339,424,340,231,327,382,195,301,231,161,129,138,130,145,130],"y":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985],"type":"scatter","xaxis":"x5","yaxis":"y5"},{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,19,22,24,25,26,28,29,31,32,34,35,36,38,39],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[162,247,160,198,468,429,216,351,223,277,292,358,351,136,392,318,244,295,197,272,317,235,393,186,205,260,141,147,152,180],"y":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985],"type":"scatter","xaxis":"x6","yaxis":"y6"},{"marker":{"color":[0,1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,19,22,24,25,26,28,29,31,32,34,35,36,38,39],"colorbar":{"title":{"text":"#Trials"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[289,206,291,232,230,234,346,285,308,336,151,464,510,484,417,139,407,441,206,450,265,379,471,208,197,244,250,255,225,274],"y":[0.9663325294852255,0.8538003005400426,0.9333370736837385,2.308023227112635,0.9594035801822195,2.3308440674943625,2.304749325097323,0.9173180745775198,0.970559313589213,2.1159408791311862,2.3026118452185833,0.8779827433663444,0.9928599794705705,2.3027173531055456,0.9710360651466702,0.9328236542642117,0.8594228555448353,0.9695012574436284,0.8793295427244536,2.302633065572926,0.9796114992436178,2.3033253585591025,1.0034908101309177,0.8815758077495073,0.874182585053719,0.8615798228979111,0.8468572935637306,2.3064591855887904,0.9325450231631596,1.0199463226821985],"type":"scatter","xaxis":"x7","yaxis":"y7"}],                        {"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,0.1183673469387755],"title":{"text":"batch_size"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Objective Value"}},"xaxis2":{"anchor":"y2","domain":[0.14693877551020407,0.26530612244897955],"title":{"text":"dense"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"matches":"y","showticklabels":false},"xaxis3":{"anchor":"y3","domain":[0.29387755102040813,0.4122448979591836],"title":{"text":"dropout"}},"yaxis3":{"anchor":"x3","domain":[0.0,1.0],"matches":"y","showticklabels":false},"xaxis4":{"anchor":"y4","domain":[0.4408163265306122,0.5591836734693877],"title":{"text":"lr"},"type":"log"},"yaxis4":{"anchor":"x4","domain":[0.0,1.0],"matches":"y","showticklabels":false},"xaxis5":{"anchor":"y5","domain":[0.5877551020408163,0.7061224489795918],"title":{"text":"vgg_b1"}},"yaxis5":{"anchor":"x5","domain":[0.0,1.0],"matches":"y","showticklabels":false},"xaxis6":{"anchor":"y6","domain":[0.7346938775510204,0.8530612244897959],"title":{"text":"vgg_b2"}},"yaxis6":{"anchor":"x6","domain":[0.0,1.0],"matches":"y","showticklabels":false},"xaxis7":{"anchor":"y7","domain":[0.8816326530612244,0.9999999999999999],"title":{"text":"vgg_b3"}},"yaxis7":{"anchor":"x7","domain":[0.0,1.0],"matches":"y","showticklabels":false},"title":{"text":"Slice Plot"},"width":1200,"height":450},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('dfa582df-5007-44f3-9728-8fece300a32e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_param_importances</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="f31af57c-45c3-41af-828b-b9f2f4c47614" class="plotly-graph-div" style="height:500px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f31af57c-45c3-41af-828b-b9f2f4c47614")) {                    Plotly.newPlot(                        "f31af57c-45c3-41af-828b-b9f2f4c47614",                        [{"cliponaxis":false,"hovertemplate":["vgg_b3 (IntLogUniformDistribution): 0.0005190927054212566<extra></extra>","dropout (DiscreteUniformDistribution): 0.0022475583048347557<extra></extra>","vgg_b2 (IntLogUniformDistribution): 0.013073350637473335<extra></extra>","dense (IntLogUniformDistribution): 0.05453751889838688<extra></extra>","batch_size (IntLogUniformDistribution): 0.06763895160105765<extra></extra>","vgg_b1 (IntLogUniformDistribution): 0.19100688173447164<extra></extra>","lr (LogUniformDistribution): 0.6709766461183545<extra></extra>"],"marker":{"color":"rgb(66,146,198)"},"orientation":"h","text":["0.0005190927054212566","0.0022475583048347557","0.013073350637473335","0.05453751889838688","0.06763895160105765","0.19100688173447164","0.6709766461183545"],"textposition":"outside","texttemplate":"%{text:.2f}","x":[0.0005190927054212566,0.0022475583048347557,0.013073350637473335,0.05453751889838688,0.06763895160105765,0.19100688173447164,0.6709766461183545],"y":["vgg_b3","dropout","vgg_b2","dense","batch_size","vgg_b1","lr"],"type":"bar"}],                        {"showlegend":false,"title":{"text":"Hyperparameter Importances"},"xaxis":{"title":{"text":"Importance for Objective Value"}},"yaxis":{"title":{"text":"Hyperparameter"}},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"width":800,"height":500},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('f31af57c-45c3-41af-828b-b9f2f4c47614');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<p>Turns out a low learning rate works for any size of the first VGG block and batch size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="s1">&#39;vgg_b1&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">autosize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="015f9a98-cde9-422b-add1-9a339ccab864" class="plotly-graph-div" style="height:700px; width:900px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("015f9a98-cde9-422b-add1-9a339ccab864")) {                    Plotly.newPlot(                        "015f9a98-cde9-422b-add1-9a339ccab864",                        [{"type":"scatter","xaxis":"x","yaxis":"y"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":true,"x":[11.649999999999999,17,18,20,21,23,25,26,27,29,30,32,33,35,39,42,48,49,50,51,56,60,68,83,85,89,124,129.35],"y":[8.234235648147144e-6,0.000013064656747928878,0.00001359546850655156,0.000019999878982282223,0.00003136450432363738,0.000055809854563142486,0.000058571334191863526,0.00005986375901071346,0.00006046048370778813,0.00006388393481294276,0.00007930129805507095,0.00009058519215325063,0.00009652575464574833,0.00010174140869152476,0.00010372443791344133,0.000132589105195643,0.00016720140088459775,0.00024037964468769132,0.00030648865735273913,0.0003701946567741201,0.0004394672803314361,0.0006663982177439894,0.0007539244254643046,0.0009895984157195427,0.0019107435528946583,0.006701555276590694,0.01014034214456914,0.013848177485291456,0.037906633402615846,0.09329797140131525,0.13353412052488867,0.21186877851701993],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.970559313589213,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,0.8779827433663444,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,0.9173180745775198,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.8594228555448353,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,1.0034908101309177,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9663325294852255,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8538003005400426,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8793295427244536,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8815758077495073,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.874182585053719,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8468572935637306,null,null,null,null,null,null,null,null,null,null],[null,null,null,0.9333370736837385,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8615798228979111,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.9695012574436284,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,0.9796114992436178,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9328236542642117,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.9928599794705705,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9325450231631596,null,null,null,null],[null,null,null,null,null,0.9710360651466702,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0199463226821985,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,2.302633065572926,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,2.3027173531055456,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3033253585591025,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.1159408791311862,null,null,null],[null,null,null,null,null,null,null,null,null,null,2.304749325097323,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3064591855887904,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.308023227112635,null,null],[null,null,2.3308440674943625,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x4","yaxis":"y4"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[124,42,20,89,68,18,30,17,51,85,33,27,32,25,23,39,26,21,51,35,23,42,29,60,48,50,49,60,83,56],"y":[0.000058571334191863526,0.00005986375901071346,0.00009652575464574833,0.09329797140131525,0.00010174140869152476,0.13353412052488867,0.013848177485291456,0.000019999878982282223,0.000013064656747928878,0.01014034214456914,0.0007539244254643046,0.00001359546850655156,0.00030648865735273913,0.0019107435528946583,0.0004394672803314361,0.00024037964468769132,0.00003136450432363738,0.000132589105195643,0.00006046048370778813,0.0009895984157195427,0.00016720140088459775,0.006701555276590694,0.000055809854563142486,0.00006388393481294276,0.00007930129805507095,0.00010372443791344133,0.00009058519215325063,0.037906633402615846,0.0003701946567741201,0.0006663982177439894],"type":"scatter","xaxis":"x4","yaxis":"y4"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[11.649999999999999,17,18,20,21,23,25,26,27,29,30,32,33,35,39,42,48,49,50,51,56,60,68,83,85,89,124,129.35],"y":[110.15,129,130,137,138,145,161,183,195,208,217,231,249,258,286,301,307,310,314,327,339,340,370,372,382,399,424,463,506,524.85],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8615798228979111,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0199463226821985,2.3064591855887904,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8468572935637306,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9325450231631596,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.874182585053719,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,0.9710360651466702,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3033253585591025,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,2.304749325097323,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.308023227112635,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8793295427244536,null,0.8815758077495073,null,null,null,null,null,null],[null,null,null,0.9333370736837385,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8538003005400426,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.9928599794705705,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,1.0034908101309177,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,2.3027173531055456,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9663325294852255,null],[null,null,null,null,null,null,null,null,0.8779827433663444,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,2.302633065572926,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9328236542642117,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.9695012574436284,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,0.9173180745775198,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null],[null,null,null,null,null,0.9796114992436178,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.970559313589213,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.8594228555448353,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,2.3308440674943625,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.1159408791311862,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x7","yaxis":"y7"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[124,42,20,89,68,18,30,17,51,85,33,27,32,25,23,39,26,21,51,35,23,42,29,60,48,50,49,60,83,56],"y":[310,258,249,217,372,463,208,370,399,506,137,314,286,307,183,339,424,340,231,327,382,195,301,231,161,129,138,130,145,130],"type":"scatter","xaxis":"x7","yaxis":"y7"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[8.234235648147144e-6,0.000013064656747928878,0.00001359546850655156,0.000019999878982282223,0.00003136450432363738,0.000055809854563142486,0.000058571334191863526,0.00005986375901071346,0.00006046048370778813,0.00006388393481294276,0.00007930129805507095,0.00009058519215325063,0.00009652575464574833,0.00010174140869152476,0.00010372443791344133,0.000132589105195643,0.00016720140088459775,0.00024037964468769132,0.00030648865735273913,0.0003701946567741201,0.0004394672803314361,0.0006663982177439894,0.0007539244254643046,0.0009895984157195427,0.0019107435528946583,0.006701555276590694,0.01014034214456914,0.013848177485291456,0.037906633402615846,0.09329797140131525,0.13353412052488867,0.21186877851701993],"y":[11.649999999999999,17,18,20,21,23,25,26,27,29,30,32,33,35,39,42,48,49,50,51,56,60,68,83,85,89,124,129.35],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,0.9173180745775198,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3308440674943625,null],[null,null,null,null,null,null,null,null,null,null,null,null,0.9333370736837385,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9695012574436284,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9796114992436178,null,null,null,0.9710360651466702,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3027173531055456,null,null,null,null,null,null,null],[null,null,null,null,0.8594228555448353,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,0.8779827433663444,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,1.0034908101309177,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.304749325097323,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9928599794705705,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.302633065572926,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9328236542642117,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.8538003005400426,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3033253585591025,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,0.874182585053719,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.8468572935637306,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8615798228979111,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,0.970559313589213,null,null,null,null,null,null,0.8793295427244536,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0199463226821985,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,0.8815758077495073,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3064591855887904,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9325450231631596,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.1159408791311862,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.308023227112635,null,null],[null,null,null,null,null,null,0.9663325294852255,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[0.000058571334191863526,0.00005986375901071346,0.00009652575464574833,0.09329797140131525,0.00010174140869152476,0.13353412052488867,0.013848177485291456,0.000019999878982282223,0.000013064656747928878,0.01014034214456914,0.0007539244254643046,0.00001359546850655156,0.00030648865735273913,0.0019107435528946583,0.0004394672803314361,0.00024037964468769132,0.00003136450432363738,0.000132589105195643,0.00006046048370778813,0.0009895984157195427,0.00016720140088459775,0.006701555276590694,0.000055809854563142486,0.00006388393481294276,0.00007930129805507095,0.00010372443791344133,0.00009058519215325063,0.037906633402615846,0.0003701946567741201,0.0006663982177439894],"y":[124,42,20,89,68,18,30,17,51,85,33,27,32,25,23,39,26,21,51,35,23,42,29,60,48,50,49,60,83,56],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"type":"scatter","xaxis":"x5","yaxis":"y5"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[8.234235648147144e-6,0.000013064656747928878,0.00001359546850655156,0.000019999878982282223,0.00003136450432363738,0.000055809854563142486,0.000058571334191863526,0.00005986375901071346,0.00006046048370778813,0.00006388393481294276,0.00007930129805507095,0.00009058519215325063,0.00009652575464574833,0.00010174140869152476,0.00010372443791344133,0.000132589105195643,0.00016720140088459775,0.00024037964468769132,0.00030648865735273913,0.0003701946567741201,0.0004394672803314361,0.0006663982177439894,0.0007539244254643046,0.0009895984157195427,0.0019107435528946583,0.006701555276590694,0.01014034214456914,0.013848177485291456,0.037906633402615846,0.09329797140131525,0.13353412052488867,0.21186877851701993],"y":[110.15,129,130,137,138,145,161,183,195,208,217,231,249,258,286,301,307,310,314,327,339,340,370,372,382,399,424,463,506,524.85],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8615798228979111,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0199463226821985,null,null,null,null,null,null,2.3064591855887904,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.8468572935637306,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9325450231631596,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,0.874182585053719,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9710360651466702,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3033253585591025,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.304749325097323,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.308023227112635,null,null],[null,null,null,null,null,null,null,null,0.8793295427244536,0.8815758077495073,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,0.9333370736837385,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.8538003005400426,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9928599794705705,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,1.0034908101309177,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3027173531055456,null,null,null,null,null,null,null],[null,null,null,null,null,null,0.9663325294852255,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,0.8779827433663444,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.302633065572926,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9328236542642117,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9695012574436284,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,0.9173180745775198,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9796114992436178,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,0.970559313589213,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.8594228555448353,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3308440674943625,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.1159408791311862,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x8","yaxis":"y8"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[0.000058571334191863526,0.00005986375901071346,0.00009652575464574833,0.09329797140131525,0.00010174140869152476,0.13353412052488867,0.013848177485291456,0.000019999878982282223,0.000013064656747928878,0.01014034214456914,0.0007539244254643046,0.00001359546850655156,0.00030648865735273913,0.0019107435528946583,0.0004394672803314361,0.00024037964468769132,0.00003136450432363738,0.000132589105195643,0.00006046048370778813,0.0009895984157195427,0.00016720140088459775,0.006701555276590694,0.000055809854563142486,0.00006388393481294276,0.00007930129805507095,0.00010372443791344133,0.00009058519215325063,0.037906633402615846,0.0003701946567741201,0.0006663982177439894],"y":[310,258,249,217,372,463,208,370,399,506,137,314,286,307,183,339,424,340,231,327,382,195,301,231,161,129,138,130,145,130],"type":"scatter","xaxis":"x8","yaxis":"y8"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[110.15,129,130,137,138,145,161,183,195,208,217,231,249,258,286,301,307,310,314,327,339,340,370,372,382,399,424,463,506,524.85],"y":[11.649999999999999,17,18,20,21,23,25,26,27,29,30,32,33,35,39,42,48,49,50,51,56,60,68,83,85,89,124,129.35],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9173180745775198,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3308440674943625,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,0.9333370736837385,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9695012574436284,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.9710360651466702,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9796114992436178,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3027173531055456,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8594228555448353,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8779827433663444,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0034908101309177,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,2.304749325097323,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9928599794705705,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.302633065572926,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9328236542642117,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,2.3033253585591025,null,null,null,null,0.8538003005400426,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,0.874182585053719,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.8468572935637306,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,0.8615798228979111,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.8793295427244536,null,null,null,null,null,null,null,null,null,null,null,null,null,0.970559313589213,null,null,null,null],[null,null,1.0199463226821985,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,2.3064591855887904,null,null,null,null,null,null,null,null,0.8815758077495073,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null,null],[null,null,null,null,null,0.9325450231631596,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.1159408791311862,null],[null,null,null,null,null,null,null,null,null,null,2.308023227112635,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9663325294852255,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x3","yaxis":"y3"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[310,258,249,217,372,463,208,370,399,506,137,314,286,307,183,339,424,340,231,327,382,195,301,231,161,129,138,130,145,130],"y":[124,42,20,89,68,18,30,17,51,85,33,27,32,25,23,39,26,21,51,35,23,42,29,60,48,50,49,60,83,56],"type":"scatter","xaxis":"x3","yaxis":"y3"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[110.15,129,130,137,138,145,161,183,195,208,217,231,249,258,286,301,307,310,314,327,339,340,370,372,382,399,424,463,506,524.85],"y":[8.234235648147144e-6,0.000013064656747928878,0.00001359546850655156,0.000019999878982282223,0.00003136450432363738,0.000055809854563142486,0.000058571334191863526,0.00005986375901071346,0.00006046048370778813,0.00006388393481294276,0.00007930129805507095,0.00009058519215325063,0.00009652575464574833,0.00010174140869152476,0.00010372443791344133,0.000132589105195643,0.00016720140088459775,0.00024037964468769132,0.00030648865735273913,0.0003701946567741201,0.0004394672803314361,0.0006663982177439894,0.0007539244254643046,0.0009895984157195427,0.0019107435528946583,0.006701555276590694,0.01014034214456914,0.013848177485291456,0.037906633402615846,0.09329797140131525,0.13353412052488867,0.21186877851701993],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.970559313589213,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8779827433663444,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9173180745775198,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8594228555448353,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0034908101309177,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9663325294852255,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,0.8538003005400426,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.8793295427244536,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.8815758077495073,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,0.874182585053719,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.8468572935637306,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,0.9333370736837385,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null,null],[null,0.8615798228979111,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9695012574436284,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9796114992436178,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9328236542642117,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9928599794705705,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,0.9325450231631596,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.9710360651466702,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,1.0199463226821985,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.302633065572926,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3027173531055456,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,2.3033253585591025,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.1159408791311862,null],[null,null,null,null,null,null,null,null,null,2.304749325097323,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,2.3064591855887904,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,2.308023227112635,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3308440674943625,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x6","yaxis":"y6"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[310,258,249,217,372,463,208,370,399,506,137,314,286,307,183,339,424,340,231,327,382,195,301,231,161,129,138,130,145,130],"y":[0.000058571334191863526,0.00005986375901071346,0.00009652575464574833,0.09329797140131525,0.00010174140869152476,0.13353412052488867,0.013848177485291456,0.000019999878982282223,0.000013064656747928878,0.01014034214456914,0.0007539244254643046,0.00001359546850655156,0.00030648865735273913,0.0019107435528946583,0.0004394672803314361,0.00024037964468769132,0.00003136450432363738,0.000132589105195643,0.00006046048370778813,0.0009895984157195427,0.00016720140088459775,0.006701555276590694,0.000055809854563142486,0.00006388393481294276,0.00007930129805507095,0.00010372443791344133,0.00009058519215325063,0.037906633402615846,0.0003701946567741201,0.0006663982177439894],"type":"scatter","xaxis":"x6","yaxis":"y6"},{"type":"scatter","xaxis":"x9","yaxis":"y9"}],                        {"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,0.2888888888888889],"matches":"x7","showticklabels":false,"range":[11.649999999999999,129.35]},"yaxis":{"anchor":"x","domain":[0.7333333333333333,1.0],"range":[11.649999999999999,129.35],"title":{"text":"batch_size"}},"xaxis2":{"anchor":"y2","domain":[0.35555555555555557,0.6444444444444445],"matches":"x8","showticklabels":false,"range":[-5.084376708479465,-0.6739330372334835],"type":"log"},"yaxis2":{"anchor":"x2","domain":[0.7333333333333333,1.0],"matches":"y","showticklabels":false,"range":[11.649999999999999,129.35]},"xaxis3":{"anchor":"y3","domain":[0.7111111111111111,1.0],"matches":"x9","showticklabels":false,"range":[110.15,524.85]},"yaxis3":{"anchor":"x3","domain":[0.7333333333333333,1.0],"matches":"y","showticklabels":false,"range":[11.649999999999999,129.35]},"xaxis4":{"anchor":"y4","domain":[0.0,0.2888888888888889],"matches":"x7","showticklabels":false,"range":[11.649999999999999,129.35]},"yaxis4":{"anchor":"x4","domain":[0.36666666666666664,0.6333333333333333],"range":[-5.084376708479465,-0.6739330372334835],"type":"log","title":{"text":"lr"}},"xaxis5":{"anchor":"y5","domain":[0.35555555555555557,0.6444444444444445],"matches":"x8","showticklabels":false,"range":[-5.084376708479465,-0.6739330372334835],"type":"log"},"yaxis5":{"anchor":"x5","domain":[0.36666666666666664,0.6333333333333333],"matches":"y4","showticklabels":false,"range":[-5.084376708479465,-0.6739330372334835],"type":"log"},"xaxis6":{"anchor":"y6","domain":[0.7111111111111111,1.0],"matches":"x9","showticklabels":false,"range":[110.15,524.85]},"yaxis6":{"anchor":"x6","domain":[0.36666666666666664,0.6333333333333333],"matches":"y4","showticklabels":false,"range":[-5.084376708479465,-0.6739330372334835],"type":"log"},"xaxis7":{"anchor":"y7","domain":[0.0,0.2888888888888889],"range":[11.649999999999999,129.35],"title":{"text":"batch_size"}},"yaxis7":{"anchor":"x7","domain":[0.0,0.26666666666666666],"range":[110.15,524.85],"title":{"text":"vgg_b1"}},"xaxis8":{"anchor":"y8","domain":[0.35555555555555557,0.6444444444444445],"range":[-5.084376708479465,-0.6739330372334835],"type":"log","title":{"text":"lr"}},"yaxis8":{"anchor":"x8","domain":[0.0,0.26666666666666666],"matches":"y7","showticklabels":false,"range":[110.15,524.85]},"xaxis9":{"anchor":"y9","domain":[0.7111111111111111,1.0],"range":[110.15,524.85],"title":{"text":"vgg_b1"}},"yaxis9":{"anchor":"x9","domain":[0.0,0.26666666666666666],"matches":"y7","showticklabels":false,"range":[110.15,524.85]},"title":{"text":"Contour Plot"},"autosize":false,"width":900,"height":700},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('015f9a98-cde9-422b-add1-9a339ccab864');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<p>For the bottom part of the network, a large width for the fully-connected block seems to work well. Meanwhile the size of the 3rd VGG block seem to be multimodal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_contour</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vgg_b3&#39;</span><span class="p">,</span> <span class="s1">&#39;dense&#39;</span><span class="p">,</span> <span class="s1">&#39;dropout&#39;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">autosize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="51490b05-b700-4390-81a5-514e638b12b5" class="plotly-graph-div" style="height:700px; width:900px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("51490b05-b700-4390-81a5-514e638b12b5")) {                    Plotly.newPlot(                        "51490b05-b700-4390-81a5-514e638b12b5",                        [{"type":"scatter","xaxis":"x","yaxis":"y"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":true,"x":[221.0,259,287,355,391,402,404,415,426,435,440,450,468,481,500,508,519,546,580,598,608,648,665,733,743,806,852,916,960,1016,1019,1057.0],"y":[0.055,0.1,0.2,0.30000000000000004,0.4,0.5,0.6,0.7000000000000001,0.8,0.9,1.0,1.045],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0034908101309177,0.9663325294852255,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9796114992436178,null,null,null,null,0.9173180745775198,2.3308440674943625,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,2.3027173531055456,0.9328236542642117,null,0.8779827433663444,null,null,null,null,null,null,null,null,null,null,0.9710360651466702,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,0.8815758077495073,0.8793295427244536,0.874182585053719,null,null,0.9928599794705705,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9333370736837385,null,null,null],[null,null,null,2.1159408791311862,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3033253585591025,null,null,null,1.0199463226821985,null,null,null,null,null,0.8615798228979111,null],[null,0.970559313589213,null,null,null,0.8538003005400426,null,0.8594228555448353,null,null,null,null,null,null,null,2.308023227112635,null,null,null,null,null,null,null,null,null,null,0.8468572935637306,0.9325450231631596,null,null,null,null],[null,null,null,null,2.304749325097323,null,null,null,null,null,null,null,null,null,null,null,null,0.9695012574436284,null,null,null,null,null,null,null,null,null,null,null,2.3064591855887904,null,null],[null,null,2.302633065572926,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x4","yaxis":"y4"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[598,402,960,508,733,665,391,648,259,355,404,500,481,450,806,468,415,546,435,287,519,608,580,426,440,1019,852,1016,916,743],"y":[0.1,0.7000000000000001,0.5,0.7000000000000001,0.2,0.30000000000000004,0.8,0.30000000000000004,0.7000000000000001,0.6,1.0,0.4,0.5,0.4,0.4,0.4,0.7000000000000001,0.8,0.5,0.9,0.30000000000000004,0.6,0.1,0.5,0.5,0.6,0.7000000000000001,0.8,0.7000000000000001,0.6],"type":"scatter","xaxis":"x4","yaxis":"y4"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[221.0,259,287,355,391,402,404,415,426,435,440,450,468,481,500,508,519,546,580,598,608,648,665,733,743,806,852,916,960,1016,1019,1057.0],"y":[120.45,139,151,197,206,208,225,230,232,234,244,250,255,265,274,285,289,291,308,336,346,379,407,417,441,450,464,471,484,510,528.55],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,0.9328236542642117,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,0.874182585053719,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,0.8538003005400426,null,null,null,0.8793295427244536,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,0.8815758077495073,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9325450231631596,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.308023227112635,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3308440674943625,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8615798228979111,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8468572935637306,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3064591855887904,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9796114992436178,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0199463226821985,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9173180745775198,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9663325294852255,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9333370736837385,null,null,null],[null,0.970559313589213,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,2.1159408791311862,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,2.304749325097323,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3033253585591025,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.8594228555448353,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9710360651466702,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9695012574436284,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,2.302633065572926,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8779827433663444,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0034908101309177,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,2.3027173531055456,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,0.9928599794705705,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x7","yaxis":"y7"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[598,402,960,508,733,665,391,648,259,355,404,500,481,450,806,468,415,546,435,287,519,608,580,426,440,1019,852,1016,916,743],"y":[289,206,291,232,230,234,346,285,308,336,151,464,510,484,417,139,407,441,206,450,265,379,471,208,197,244,250,255,225,274],"type":"scatter","xaxis":"x7","yaxis":"y7"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[0.055,0.1,0.2,0.30000000000000004,0.4,0.5,0.6,0.7000000000000001,0.8,0.9,1.0,1.045],"y":[221.0,259,287,355,391,402,404,415,426,435,440,450,468,481,500,508,519,546,580,598,608,648,665,733,743,806,852,916,960,1016,1019,1057.0],"z":[[null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.970559313589213,null,null,null,null],[null,null,null,null,null,null,null,null,null,2.302633065572926,null,null],[null,null,null,null,null,null,2.1159408791311862,null,null,null,null,null],[null,null,null,null,null,null,null,null,2.304749325097323,null,null,null],[null,null,null,null,null,null,null,0.8538003005400426,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,2.3026118452185833,null],[null,null,null,null,null,null,null,0.8594228555448353,null,null,null,null],[null,null,null,null,null,0.8815758077495073,null,null,null,null,null,null],[null,null,null,null,null,0.8793295427244536,null,null,null,null,null,null],[null,null,null,null,null,0.874182585053719,null,null,null,null,null,null],[null,null,null,null,2.3027173531055456,null,null,null,null,null,null,null],[null,null,null,null,0.9328236542642117,null,null,null,null,null,null,null],[null,null,null,null,null,0.9928599794705705,null,null,null,null,null,null],[null,null,null,null,0.8779827433663444,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,2.308023227112635,null,null,null,null],[null,null,null,0.9796114992436178,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,0.9695012574436284,null,null,null],[null,1.0034908101309177,null,null,null,null,null,null,null,null,null,null],[null,0.9663325294852255,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,2.3033253585591025,null,null,null,null,null],[null,null,null,0.9173180745775198,null,null,null,null,null,null,null,null],[null,null,null,2.3308440674943625,null,null,null,null,null,null,null,null],[null,null,0.9594035801822195,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,1.0199463226821985,null,null,null,null,null],[null,null,null,null,0.9710360651466702,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.8468572935637306,null,null,null,null],[null,null,null,null,null,null,null,0.9325450231631596,null,null,null,null],[null,null,null,null,null,0.9333370736837385,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,2.3064591855887904,null,null,null],[null,null,null,null,null,null,0.8615798228979111,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[0.1,0.7000000000000001,0.5,0.7000000000000001,0.2,0.30000000000000004,0.8,0.30000000000000004,0.7000000000000001,0.6,1.0,0.4,0.5,0.4,0.4,0.4,0.7000000000000001,0.8,0.5,0.9,0.30000000000000004,0.6,0.1,0.5,0.5,0.6,0.7000000000000001,0.8,0.7000000000000001,0.6],"y":[598,402,960,508,733,665,391,648,259,355,404,500,481,450,806,468,415,546,435,287,519,608,580,426,440,1019,852,1016,916,743],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"type":"scatter","xaxis":"x5","yaxis":"y5"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[0.055,0.1,0.2,0.30000000000000004,0.4,0.5,0.6,0.7000000000000001,0.8,0.9,1.0,1.045],"y":[120.45,139,151,197,206,208,225,230,232,234,244,250,255,265,274,285,289,291,308,336,346,379,407,417,441,450,464,471,484,510,528.55],"z":[[null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.9328236542642117,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,2.3026118452185833,null],[null,null,null,null,null,0.874182585053719,null,null,null,null,null,null],[null,null,null,null,null,0.8793295427244536,null,0.8538003005400426,null,null,null,null],[null,null,null,null,null,0.8815758077495073,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.9325450231631596,null,null,null,null],[null,null,0.9594035801822195,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,2.308023227112635,null,null,null,null],[null,null,null,2.3308440674943625,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,0.8615798228979111,null,null,null,null,null],[null,null,null,null,null,null,null,0.8468572935637306,null,null,null,null],[null,null,null,null,null,null,null,null,2.3064591855887904,null,null,null],[null,null,null,0.9796114992436178,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,1.0199463226821985,null,null,null,null,null],[null,null,null,0.9173180745775198,null,null,null,null,null,null,null,null],[null,0.9663325294852255,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,0.9333370736837385,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.970559313589213,null,null,null,null],[null,null,null,null,null,null,2.1159408791311862,null,null,null,null,null],[null,null,null,null,null,null,null,null,2.304749325097323,null,null,null],[null,null,null,null,null,null,2.3033253585591025,null,null,null,null,null],[null,null,null,null,null,null,null,0.8594228555448353,null,null,null,null],[null,null,null,null,0.9710360651466702,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,0.9695012574436284,null,null,null],[null,null,null,null,null,null,null,null,null,2.302633065572926,null,null],[null,null,null,null,0.8779827433663444,null,null,null,null,null,null,null],[null,1.0034908101309177,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,2.3027173531055456,null,null,null,null,null,null,null],[null,null,null,null,null,0.9928599794705705,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x8","yaxis":"y8"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[0.1,0.7000000000000001,0.5,0.7000000000000001,0.2,0.30000000000000004,0.8,0.30000000000000004,0.7000000000000001,0.6,1.0,0.4,0.5,0.4,0.4,0.4,0.7000000000000001,0.8,0.5,0.9,0.30000000000000004,0.6,0.1,0.5,0.5,0.6,0.7000000000000001,0.8,0.7000000000000001,0.6],"y":[289,206,291,232,230,234,346,285,308,336,151,464,510,484,417,139,407,441,206,450,265,379,471,208,197,244,250,255,225,274],"type":"scatter","xaxis":"x8","yaxis":"y8"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[120.45,139,151,197,206,208,225,230,232,234,244,250,255,265,274,285,289,291,308,336,346,379,407,417,441,450,464,471,484,510,528.55],"y":[221.0,259,287,355,391,402,404,415,426,435,440,450,468,481,500,508,519,546,580,598,608,648,665,733,743,806,852,916,960,1016,1019,1057.0],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.970559313589213,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.302633065572926,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.1159408791311862,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.304749325097323,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.8538003005400426,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8594228555448353,null,null,null,null,null,null,null,null],[null,null,null,null,null,0.8815758077495073,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.8793295427244536,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,0.874182585053719,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3027173531055456,null,null],[null,0.9328236542642117,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9928599794705705,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8779827433663444,null,null,null,null],[null,null,null,null,null,null,null,null,2.308023227112635,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,0.9796114992436178,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9695012574436284,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0034908101309177,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9663325294852255,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.3033253585591025,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9173180745775198,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,2.3308440674943625,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,1.0199463226821985,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9710360651466702,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.8468572935637306,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,0.9325450231631596,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9333370736837385,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,2.3064591855887904,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,0.8615798228979111,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x3","yaxis":"y3"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[289,206,291,232,230,234,346,285,308,336,151,464,510,484,417,139,407,441,206,450,265,379,471,208,197,244,250,255,225,274],"y":[598,402,960,508,733,665,391,648,259,355,404,500,481,450,806,468,415,546,435,287,519,608,580,426,440,1019,852,1016,916,743],"type":"scatter","xaxis":"x3","yaxis":"y3"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0,"rgb(5,10,172)"],[0.35,"rgb(40,60,190)"],[0.5,"rgb(70,100,245)"],[0.6,"rgb(90,120,245)"],[0.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":true,"showscale":false,"x":[120.45,139,151,197,206,208,225,230,232,234,244,250,255,265,274,285,289,291,308,336,346,379,407,417,441,450,464,471,484,510,528.55],"y":[0.055,0.1,0.2,0.30000000000000004,0.4,0.5,0.6,0.7000000000000001,0.8,0.9,1.0,1.045],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9663325294852255,null,null,null,null,null,null,null,null,null,null,1.0034908101309177,null,null,null],[null,null,null,null,null,null,null,0.9594035801822195,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,2.3308440674943625,null,null,null,0.9796114992436178,null,0.9173180745775198,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,0.9328236542642117,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9710360651466702,null,null,0.8779827433663444,null,2.3027173531055456,null,null],[null,null,null,0.874182585053719,0.8793295427244536,0.8815758077495073,null,null,null,null,null,null,null,null,null,null,null,0.9333370736837385,null,null,null,null,null,null,null,null,null,null,null,0.9928599794705705,null],[null,null,null,null,null,null,null,null,null,null,0.8615798228979111,null,null,null,1.0199463226821985,null,null,null,null,2.1159408791311862,null,2.3033253585591025,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.8538003005400426,null,0.9325450231631596,null,2.308023227112635,null,null,0.8468572935637306,null,null,null,null,null,null,0.970559313589213,null,null,null,0.8594228555448353,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,2.3064591855887904,null,null,null,null,null,null,null,2.304749325097323,null,null,null,0.9695012574436284,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2.302633065572926,null,null,null,null,null],[null,null,2.3026118452185833,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x6","yaxis":"y6"},{"marker":{"color":"black","line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"x":[289,206,291,232,230,234,346,285,308,336,151,464,510,484,417,139,407,441,206,450,265,379,471,208,197,244,250,255,225,274],"y":[0.1,0.7000000000000001,0.5,0.7000000000000001,0.2,0.30000000000000004,0.8,0.30000000000000004,0.7000000000000001,0.6,1.0,0.4,0.5,0.4,0.4,0.4,0.7000000000000001,0.8,0.5,0.9,0.30000000000000004,0.6,0.1,0.5,0.5,0.6,0.7000000000000001,0.8,0.7000000000000001,0.6],"type":"scatter","xaxis":"x6","yaxis":"y6"},{"type":"scatter","xaxis":"x9","yaxis":"y9"}],                        {"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,0.2888888888888889],"matches":"x7","showticklabels":false,"range":[221.0,1057.0]},"yaxis":{"anchor":"x","domain":[0.7333333333333333,1.0],"range":[221.0,1057.0],"title":{"text":"dense"}},"xaxis2":{"anchor":"y2","domain":[0.35555555555555557,0.6444444444444445],"matches":"x8","showticklabels":false,"range":[0.055,1.045]},"yaxis2":{"anchor":"x2","domain":[0.7333333333333333,1.0],"matches":"y","showticklabels":false,"range":[221.0,1057.0]},"xaxis3":{"anchor":"y3","domain":[0.7111111111111111,1.0],"matches":"x9","showticklabels":false,"range":[120.45,528.55]},"yaxis3":{"anchor":"x3","domain":[0.7333333333333333,1.0],"matches":"y","showticklabels":false,"range":[221.0,1057.0]},"xaxis4":{"anchor":"y4","domain":[0.0,0.2888888888888889],"matches":"x7","showticklabels":false,"range":[221.0,1057.0]},"yaxis4":{"anchor":"x4","domain":[0.36666666666666664,0.6333333333333333],"range":[0.055,1.045],"title":{"text":"dropout"}},"xaxis5":{"anchor":"y5","domain":[0.35555555555555557,0.6444444444444445],"matches":"x8","showticklabels":false,"range":[0.055,1.045]},"yaxis5":{"anchor":"x5","domain":[0.36666666666666664,0.6333333333333333],"matches":"y4","showticklabels":false,"range":[0.055,1.045]},"xaxis6":{"anchor":"y6","domain":[0.7111111111111111,1.0],"matches":"x9","showticklabels":false,"range":[120.45,528.55]},"yaxis6":{"anchor":"x6","domain":[0.36666666666666664,0.6333333333333333],"matches":"y4","showticklabels":false,"range":[0.055,1.045]},"xaxis7":{"anchor":"y7","domain":[0.0,0.2888888888888889],"range":[221.0,1057.0],"title":{"text":"dense"}},"yaxis7":{"anchor":"x7","domain":[0.0,0.26666666666666666],"range":[120.45,528.55],"title":{"text":"vgg_b3"}},"xaxis8":{"anchor":"y8","domain":[0.35555555555555557,0.6444444444444445],"range":[0.055,1.045],"title":{"text":"dropout"}},"yaxis8":{"anchor":"x8","domain":[0.0,0.26666666666666666],"matches":"y7","showticklabels":false,"range":[120.45,528.55]},"xaxis9":{"anchor":"y9","domain":[0.7111111111111111,1.0],"range":[120.45,528.55],"title":{"text":"vgg_b3"}},"yaxis9":{"anchor":"x9","domain":[0.0,0.26666666666666666],"matches":"y7","showticklabels":false,"range":[120.45,528.55]},"title":{"text":"Contour Plot"},"autosize":false,"width":900,"height":700},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('51490b05-b700-4390-81a5-514e638b12b5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<p>In conclusion, the search results don‚Äôt look too good. Perhaps because we used (6, 6) for the spatial dimension of the average pooling at the end. Also, the size of the CIFAR-10 images is too small (32x32). Moreover, the dataset is reduced to half (25,000 images). But it‚Äôs nice to see how hyperparameter tuning can be used to inform neural architecture search.</p>
</div>
</div>
<div class="section" id="appendix-hyperparameters-of-commonly-used-models">
<h2>Appendix: Hyperparameters of commonly used models<a class="headerlink" href="#appendix-hyperparameters-of-commonly-used-models" title="Permalink to this headline">¬∂</a></h2>
<br><div class="figure align-default" id="hyp">
<img alt="../_images/hyp.png" src="../_images/hyp.png" />
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Table from p. 184 of <span id="id7">[<a class="reference internal" href="blending-stacking.html#id12">Tha20</a>]</span>. <strong>RS</strong><span class="math notranslate nohighlight">\(^*\)</span> implies random search should be better.</span><a class="headerlink" href="#hyp" title="Permalink to this image">¬∂</a></p>
</div>
<div class="section" id="auto-xgboost">
<h3>Auto XGBoost<a class="headerlink" href="#auto-xgboost" title="Permalink to this headline">¬∂</a></h3>
<p>The following search space is used to tune XGBoost in the <a class="reference external" href="https://github.com/abhishekkrthakur/autoxgb">autoxgb</a> package:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#https://github.com/abhishekkrthakur/autoxgb/blob/main/src/autoxgb/params.py</span>
<span class="k">def</span> <span class="nf">get_params</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">model_config</span><span class="p">):</span>
    
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;learning_rate&quot;</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="s2">&quot;reg_lambda&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;reg_lambda&quot;</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="s2">&quot;reg_alpha&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;reg_alpha&quot;</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="s2">&quot;subsample&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;subsample&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
        <span class="s2">&quot;colsample_bytree&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;colsample_bytree&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
        <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;max_depth&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="s2">&quot;early_stopping_rounds&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;early_stopping_rounds&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
        <span class="s2">&quot;n_estimators&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;n_estimators&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7000</span><span class="p">,</span> <span class="mi">15000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">]),</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="n">model_config</span><span class="o">.</span><span class="n">use_gpu</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;tree_method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gpu_hist&quot;</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;gpu_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;predictor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gpu_predictor&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;tree_method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;tree_method&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;exact&quot;</span><span class="p">,</span> <span class="s2">&quot;approx&quot;</span><span class="p">,</span> <span class="s2">&quot;hist&quot;</span><span class="p">])</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;booster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;booster&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;gbtree&quot;</span><span class="p">,</span> <span class="s2">&quot;gblinear&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;booster&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;gbtree&quot;</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;grow_policy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;grow_policy&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;depthwise&quot;</span><span class="p">,</span> <span class="s2">&quot;lossguide&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">params</span>
</pre></div>
</div>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="ref4"><span class="brackets"><a class="fn-backref" href="#id4">1</a></span></dt>
<dd><p>See <a class="reference external" href="https://github.com/optuna/optuna-dashboard">Optuna dashboard</a> which displays the same plots that are updated in real-time.</p>
</dd>
<dt class="label" id="ref3"><span class="brackets"><a class="fn-backref" href="#id6">2</a></span></dt>
<dd><p>In practice, we save the best model parameters at this point.</p>
</dd>
</dl>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"1441e512780e4da9b1403adeddc4a8c8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4eeb2455c9b34c5fb99b992fc7ed2923": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "5d1993403e534227b6c2076bf171b76f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_f993bef131e649eaa8825048cdacd055", "placeholder": "\u200b", "style": "IPY_MODEL_66fad21e17744d96ab1fd2bc86162746", "value": ""}}, "66fad21e17744d96ab1fd2bc86162746": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "874d09352da144458fe7fc60af026327": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9d96ea76728645b5b3727b6f321b9ee0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_874d09352da144458fe7fc60af026327", "placeholder": "\u200b", "style": "IPY_MODEL_d7ca7e31b8e04131ab1784170be60469", "value": " 170499072/? [00:02&lt;00:00, 85506554.84it/s]"}}, "bdbe4666f9514b6184081dad09e5ea64": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_e912189511fc4a2c8a628d6a100fcc54", "max": 170498071, "min": 0, "orientation": "horizontal", "style": "IPY_MODEL_4eeb2455c9b34c5fb99b992fc7ed2923", "value": 170498071}}, "d7ca7e31b8e04131ab1784170be60469": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "e912189511fc4a2c8a628d6a100fcc54": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f526ee1acb344c17a1fa5c35271c0255": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_5d1993403e534227b6c2076bf171b76f", "IPY_MODEL_bdbe4666f9514b6184081dad09e5ea64", "IPY_MODEL_9d96ea76728645b5b3727b6f321b9ee0"], "layout": "IPY_MODEL_1441e512780e4da9b1403adeddc4a8c8"}}, "f993bef131e649eaa8825048cdacd055": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="blending-stacking.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Blending and Stacking</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="backpropagation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Backpropagation on DAGs</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By ùó•ùóºùóª ùó†ùó≤ùó±ùó∂ùóªùóÆ. Powered by <a href="https://jupyterbook.org">Jupyter Book</a>.<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>